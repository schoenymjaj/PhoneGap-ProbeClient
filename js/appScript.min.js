$(function(){$("[data-role=panel]").panel();$("[data-role=panel]").listview();$("[data-role=panel]").trigger("create"),function(n){function tt(n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t="",o,s,h,c,f,u,e,i=0;do c=r.indexOf(n.charAt(i++)),f=r.indexOf(n.charAt(i++)),u=r.indexOf(n.charAt(i++)),e=r.indexOf(n.charAt(i++)),o=c<<2|f>>4,s=(f&15)<<4|u>>2,h=(u&3)<<6|e,t=t+String.fromCharCode(o),u!=64&&(t=t+String.fromCharCode(s)),e!=64&&(t=t+String.fromCharCode(h));while(i<n.length);return t}var k="1.3.3",it=8,yt=GetRootUrl(),l=yt+"api/",pt=l+"Reports/GetPlayerMatchSummaryData/",wt=l+"Reports/GetPlayerMatchDetailData/",bt=l+"Reports/GetPlayerTestDetailData/",kt=l+"Reports/GetGameLMSSummaryData/",dt=l+"Reports/GetPlayerLMSSummaryData/",gt=l+"Reports/GetPlayerLMSDetailData/",rt="NO-NAME",h="",c=-1,ut=-1,ft=0,et=1,y=2,ni=3,ot="green",g="red",d=1,st=5,ht="AnswerSubmitSuccessMessage",ti="AnswerSubmitFailMessage",ii="SubmitConfirmMessage",nt="QuestionTimeWarningInSecs",a=0,ri=1,ui=2,fi=3,ei=4,oi=5,si=6,hi=7,ci=8,li=9,ct=10,ai=11,vi=12,yi=0,pi=1,wi=2,bi=3,ki=4,di=5,gi=-621355968e5,nr=3e4,e=ft,v=-1,t={},u={Match:"Match",Test:"Test",LMS:"Last Man Standing"},r={Idle:0,Active:1,Submitted:2,ReadOnly:3,SubmittedActive:4},p={Unknown:0,Male:1,Female:2},s={MatchSummary:0,MatchDetail:1,TestDetail:2,GameLMSSummary:3,PlayerLMSSummary:4,LMSDetail:5},f={Global:0,Game:1},o=r.Idle,tr=10,w=undefined,ir=3,lt=!1,at=5,vt=new Date("1/1/2001"),b=!1;n.init=function(){k=="1.3.0"&&localStorage.ProbeVersionNbr==undefined&&(localStorage.clear(),localStorage.ProbeVersionNbr=k);n.bindings()};n.bindings=function(){$(document).on("ready",function(){$(function(){$("body").data("env")=="production"&&(console.log=function(){})});w=undefined;QryStr("code")!=undefined&&QryStr("code")!=""&&(w=decodeURI(QryStr("code")));w==undefined&&n.SetHomePageInitialDisplay();n.BindPageStaticEvents("misc");n.BindPageStaticEvents("#question");n.BindPageStaticEvents("#summary");w!=undefined&&(n.SetHomePageStyle(!1),n.GetGameServer(w));n.AdjustPagePaddingTop()});$(window).resize(function(){console.log("resize triggered");n.SetHeaderImage()})};n.SetHomePageInitialDisplay=function(){console.log("START app.SetHomePageInitialDisplay w:"+$(window).width()+" h:"+$(window).height());GameListQueue=n.GetGameListQueueLocalStorage();n.SetHeaderImage();o==r.Idle&&($("[data-icon='plus']").removeClass("ui-disabled"),$("[data-icon='minus']").addClass("ui-disabled"));(new n.Game).IsGameInProgress()||GameListQueue.length>0?n.HomePageInitialDisplayListview():n.HomePageInitialDisplayInstruct();n.BindPageStaticEvents("#home");$("#aboutBtn").click(function(){n.DisplayAboutPage()});console.log("END app.SetHomePageInitialDisplay")};n.HomePageInitialDisplayListview=function(){console.log("START app.HomePageInitialDisplayListview");gameObj=new n.Game;n.PopActiveGameFromQueueIntoCurrent();gameObj.StartupClockCountdown();GameListQueue=n.GetGameListQueueLocalStorage();n.SetHomePageStyle(!1);listViewHtml="";listViewHtml+='<ul id="gameList" data-role="listview" data-split-icon="bar-chart-o" data-inset="true">';gameObj.IsGameInProgress()?($("[data-icon='plus']").addClass("ui-disabled"),$("[data-icon='minus']").removeClass("ui-disabled"),GameData=n.GetGameLocalStorage(),t=n.GetResultLocalStorage(),playerName=n.GetPlayerName()!=rt?n.GetPlayerName():"(Player not named)",listViewHtml+='<li data-role="list-divider">Active Game<span class="ui-li-count">1<\/span><\/li><li data-icon="'+gameObj.GetListViewReportIconHtml()+'" data-game="active" data-index="-1"><a href="#"><span class="listviewGameName">'+GameData.Name+'<\/span><p class="listviewPlayerName">'+playerName+"<\/p>"+gameObj.GetListviewClockCountdownHtml()+"<\/a>"+gameObj.GetListViewReportBtnHtml()+"<\/li>"):n.IsGamesInQueue(r.Active)||n.IsGamesInQueue(r.SubmittedActive)?($("[data-icon='plus']").addClass("ui-disabled"),$("[data-icon='minus']").removeClass("ui-disabled"),index=n.GetActiveGameIndexInQueue(),listViewHtml+='<li data-role="list-divider">Active Game<span class="ui-li-count">1<\/span><\/li><li data-icon="'+gameObj.GetListViewReportIconHtml()+' data-game="active" data-index="'+n.GetActiveGameIndexInQueue()+'"><a href="#"><span class="listviewGameName">'+GameListQueue[index].Name+'<\/span><p class="listviewPlayerName">'+n.GetPlayerName(GameListQueue[index].FirstName,GameListQueue[index].NickName,GameListQueue[index].LastName,GameListQueue[index].Email)+"<\/p>"+gameObj.GetListviewClockCountdownHtml()+"<\/a>"+gameObj.GetListViewReportBtnHtml()+"<\/li>"):listViewHtml+='<li data-role="list-divider">No Active Game<span class="ui-li-count">0<\/span><\/li>';n.IsGamesInQueue(r.Submitted)&&(listViewHtml+='<li data-role="list-divider">Submitted Games<span class="ui-li-count">'+n.GetNbrGamesInQueue(r.Submitted)+"<\/span><\/li>");GameListQueue.forEach(function(t,i){t.GameState==r.Submitted&&(listViewHtml+='<li data-icon="bar-chart-o" data-game="submitted" data-index="'+i+'" data-Gameid="'+t.GameId+'"><a href="#" class="gameResumeAction"  data-index="'+i+'"><span class="listviewGameName">'+t.Name+'<\/span><br/><span class="listviewPlayerName">'+n.GetPlayerName(t.FirstName,t.NickName,t.LastName,t.Email)+'<\/span><\/a><a href="#" class="gameReportAction"  data-index="'+i+'"><\/a>',"<\/li>")});listViewHtml+="<\/ul>";$("#homePageContent").html(listViewHtml);$("#gameList").listview().listview("refresh").trigger("create");gameObj.RunQuesCountdownOnce();console.log("END app.HomePageInitialDisplayListview")};n.HomePageInitialDisplayInstruct=function(){console.log("START app.HomePageInitialDisplayInstruct");n.SetHomePageStyle(!0);gameInstructions='<h3 style="text-align: center">Welcome to <i>In Common<\/i>!<\/h3>                               You will need a game code from a game organizer to play. No code yet! Try the:                                <div class="demoGameLinkDiv"><button id="demoGameLink" class="ui-btn ui-corner-all ui-btn-icon-right ui-icon-action" data-democode="Practice Match">Practice Game<\/button><\/div>                               <p>To enter a code, click the Add icon on the top bar.                                <i>In Common<\/i> may take a few moments to retrieve your game.<\/p>                               <p>You will be prompted for information to be recognized. Start your game then answer the question(s) and submit.<\/p>                               <div class="AboutButtonDiv"><button id="aboutBtn" class="ui-btn ui-corner-all ui-btn-icon-right ui-icon-book" data-icon="book">Want to Know More?<\/button><\/div>';$("#homePageContent").html(gameInstructions);$("#homePageContent").css("color","#000000");$("#homePageContent").css("font-size","1.2em");$("#homePageContent").css("font-weight","bold");$("#home").trigger("create");$("#demoGameLink").click(function(){n.SetHomePageStyle(!1);n.GetGameServer($(this).attr("data-democode"))});console.log("END app.HomePageInitialDisplayInstruct")};n.SetGameCodePrompt=function(){console.log("START app.SetGameCodePrompt");promptforCodeHtml='<div style="margin-top: 10px"><label for="code" class="gameCode">Game Code<\/label><input name="code" id="gameCode" type="text" value="" data-clear-btn="true"><table><tr><td><button id="callGetPlays" class="ui-btn" data-icon="action">Find Game<\/button><\/td><td><button id="cancelGame" class="ui-btn" data-icon="action">Cancel<\/button><\/td><\/tr><\/table><\/div>';$("#homePageContent").html(promptforCodeHtml);$("#homePageContent").trigger("create");$(window).trigger("resize");$("#callGetPlays").click(function(){gameCode=$("#gameCode").val();gameCode.length>0?$("#gameCode").val()=="incommon-settings"?n.popUpHelper("Info","InCommon version ="+k+"<\/br>InCommon version ="+it+"<\/br>InCommon rootUrl ="+l+"<\/br>screen width = "+$(window).width()+"<\/br>screen height = "+$(window).height()+"<\/br>timezone offset = "+(new Date).getTimezoneOffset()+"<\/br>browser = "+navigator.userAgent,null):$("#gameCode").val().indexOf("incommon-ping-")!=-1?(pingInterval=parseInt($("#gameCode").val().substr(14,$("#gameCode").val().length))*1e3,n.popUpHelper("Info","Ping of In Common Server starting - ping interval: "+pingInterval,null),console.log("Ping of In Common Server starting - ping interval: "+pingInterval),setInterval(function(){n.PingInCommonServer()},pingInterval)):n.GetGameServer($("#gameCode").val()):n.popUpHelper("Error","The game code cannot be blank.","Please enter a game code.")});$("#cancelGame").click(function(){n.CancelGame()});$("#gameCode").focus();console.log("END app.SetGameCodePrompt")};n.PingInCommonServer=function(){console.log("Ping Date: "+new Date);n.GetGameStatusServer("GameStatusResponseForPing","Practice Match")};n.GetGameServer=function(t){console.log("START app.GetGameServer MNS");$.mobile.loading("show");url=l+"Games/GetGame/"+t+"/"+it;console.log("START app.GetGameServer AJAX url:"+url);$.getJSON(url).done(function(t){if(console.log("return GetGame success"),t.errorid==undefined)url=l+"GameConfigurations/GetGameConfiguration/"+t.Code,console.log("START app.GetConfigServer AJAX url:"+url),n.ajaxHelper(url,"GET",!0,null).done(function(i){if(console.log("return GetConfigServer success"),$.mobile.loading("hide"),i.errorid==undefined)n.PutGameConfigLocalStorage(i),n.IsGameSubmitted(t.Id)&&$.parseJSON(n.GetConfigValue(f.Game,"DeviceCanPlayGameOnlyOnce"))?n.popUpHelper("Error","Game '"+t.Name+"' has already been submitted.","A device cannot submit the same game twice for this game type."):(n.InitalizeGame(t),n.SetGamePlayerPrompt());else{errorMessage=i.errormessage;switch(i.errorid){case 1:errorMessage="There is no configuration for the game code entered.";break;default:errorMessage=i.errormessage}n.popUpHelper("Error",errorMessage,null)}}).fail(function(t,i,r){console.log("return GetConfigServer fail");$.mobile.loading("hide");errorMessage=n.GetAJAXFailureErrMessage("Get Game Configuration Status",i,r);n.popUpHelper("Error",errorMessage,null)});else{$.mobile.loading("hide");errorMessage=t.errormessage;errorMessagePrompt="";switch(t.errorid){case 1:errorMessage="There is no game found for the code entered.";errorMessagePrompt="Please enter the correct code.";break;case 2:errorMessage="The game found for the entered code is no longer active.";break;case 13:errorMessage=t.errormessage;errorMessagePrompt="";break;case 18:errorMessage="The game found has been suspended.";break;default:errorMessage=t.errormessage;errorMessagePrompt="Please enter the correct code."}n.popUpHelper("Error",errorMessage,errorMessagePrompt)}}).fail(function(t,i,r){console.log("return GetGame fail");$.mobile.loading("hide");n.popUpHelper("Error",n.GetAJAXFailureErrMessage("Get Game",i,r),null)});console.log("END app.GetGameServer MNS")};n.GetGameStatusServer=function(i,r){console.log("START app.GetGameStatusServer");var f=!1,u=undefined;url=l+"Games/GetGameByCode/"+r;console.log("START app.GetGameStatusServer AJAX url:"+url);n.ajaxHelper(url,"GET",!0,null).done(function(r){if(console.log("return GetGameStatus success"),respArgs=new DynamicFunctionArgs,respArgs.App=n,respArgs.UserArg1=!1,r.errorid==undefined)t=n.GetResultLocalStorage(t),f=r.ClientReportAccess,t.ClientReportAccess=r.ClientReportAccess,t.PlayerCount=r.PlayerCount,n.PutResultLocalStorage(t),respArgs.UserArg1=f;else{u=r.errormessage;switch(r.errorid){case 1:u="There is no game found for the id entered.";break;default:u=r.errormessage}respArgs.ErrorId=r.errorid;respArgs.ErrorMessage=u}window[i](respArgs)}).fail(function(t,r,f){console.log("return GetGameStatus fail");u=n.GetAJAXFailureErrMessage("Get Game Play Status",r,f);respArgs.ErrorMessage=u;window[i](respArgs)});console.log("END app.GetGameStatusServer")};n.PostGameAnswersServer=function(){console.log("START app.PostGameAnswersServer");returnErrMsg=null;t=n.GetResultLocalStorage();playerDTOin=(new n.Player).PlayerCreate();playerDTOin.GameAnswer=(new n.GameAnswers).GameAnswersCreate(playerDTOin);url=l+"Players/PostPlayer";console.log("START app.PostGameAnswersServer AJAX url:"+url);n.ajaxHelper(url,"POST",!0,playerDTOin).done(function(t){console.log("return POSTPlayer success");returnErrMsg=(new n.Game).PostGAResponse(t);n.CompleteConfirmSubmit(returnErrMsg)}).fail(function(i,r,u){console.log("return POSTPlayer fail");t=n.GetResultLocalStorage();t.ServerResponse=ri;n.PutResultLocalStorage(t);returnErrMsg=n.GetAJAXFailureErrMessage("Post Player",r,u);n.CompleteConfirmSubmit(returnErrMsg)});console.log("END app.PostGameAnswersServer")};n.GetInCommonConfigServer=function(){console.log("START app.GetInCommonConfigServer");$.mobile.loading("show");url=l+"GameConfigurations/GetConfiguration/incommon-code-around";console.log("START app.GetInCommonConfigServer AJAX url:"+url);$.getJSON(url).done(function(t){console.log("return GetInCommonConfigServer success");t.errorid==undefined?(n.PutInCommonConfigLocalStorage(t),aboutHtml=n.GetConfigValue(f.Global,"InCommon-About"),at=parseInt(n.GetConfigValue(f.Global,"InCommon-CacheMinutes")),$("#aboutContent").html(aboutHtml),$("#accordion").accordion({heightStyle:"content",autoHeight:!1,clearStyle:!0}),$.mobile.loading("hide")):($.mobile.loading("hide"),errorMessage=t.errormessage,n.popUpHelper("Error",errorMessage,"In Common request error occurred."))}).fail(function(t,i,r){console.log("return GetInCommonConfigServer fail");$.mobile.loading("hide");n.popUpHelper("Error",n.GetAJAXFailureErrMessage("Get InCommon Configuration",i,r),null)});console.log("END app.GetInCommonConfigServer")};n.GetConfigServer=function(t){console.log("START app.GetConfigServer");var u=0,r=!0,i="";do i="",u++,console.log("START app.GetConfigServer ajax try:"+u),url=l+"GameConfigurations/GetGameConfiguration/"+t,console.log("START app.GetConfigServer AJAX url:"+url),n.ajaxHelper(url,"GET",!0,null).done(function(t){if(console.log("return GetConfigServer success"),t.errorid==undefined)n.PutGameConfigLocalStorage(t),r=!0;else{i=t.errormessage;switch(t.errorid){case 1:i="There is no configuration for the game code entered.";break;default:i=t.errormessage}r=!1}}).fail(function(t,u,f){console.log("return GetConfigServer fail");i=n.GetAJAXFailureErrMessage("Get Game Configuration Status",u,f);r=!1});while(!r&&u<ir);if(console.log("END app.GetConfigServer"),i=="")return!0;throw i;};n.SetGamePlayerPrompt=function(){console.log("START app.SetGamePlayerPrompt");GameData=n.GetGameLocalStorage();t=n.GetResultLocalStorage();gameDescription="No Description";GameData.Description!=null&&(gameDescription=GameData.Description);promptforPlayerHtml='<div style="margin-top: 10px"><label for="gpType">('+GameData.GameType+' Game)<\/label><textarea name="gpType" id="gpType" class="gpType" disabled="disabled">'+GameData.Name+" ("+gameDescription+")<\/textarea>"+new n.JQMWidget("firstName").JQMRender()+new n.JQMWidget("nickName").JQMRender()+new n.JQMWidget("lastName").JQMRender()+new n.JQMWidget("email").JQMRender()+new n.JQMWidget("sex").JQMRender()+'<table><tr><td><button id="startGame" class="ui-btn" data-icon="action">Start Game<\/button><\/td><td><button id="cancelGame" class="ui-btn" data-icon="action">Cancel<\/button><\/td><td><button id="reportGame" class="ui-btn" data-icon="action">Results<\/button><\/td><\/tr><\/table><\/div>';$("#homePageContent").html(promptforPlayerHtml);(new n.Game).PlayerPromptInteractive();$("#sex-male").parent().css("width","70px");$('input[name="sex"]').on("change",function(){$(this).attr("id")=="sex-male"?($("#sex-male").attr("checked",!0),$("#sex-female").attr("checked",!1)):($("#sex-male").attr("checked",!1),$("#sex-female").attr("checked",!0))});$("#startGame").click(function(){console.log("#startGame event triggered");try{n.JQMWidgetsAllValidate()}catch(i){n.popUpHelper("Error",i,"Please enter this again.");return}t=n.GetResultLocalStorage();t.FirstName=new n.JQMWidget("firstName").JQMGetValue();t.NickName=new n.JQMWidget("nickName").JQMGetValue();t.LastName=new n.JQMWidget("lastName").JQMGetValue();t.Email=new n.JQMWidget("email").JQMGetValue();t.Sex=new n.JQMWidget("sex").JQMGetValue();n.PutResultLocalStorage(t);defaultHackWaitmsec=100;defaultHackWaitmsec=navigator.userAgent.match(/Android/i)?1e4:100;console.log("defaultHackWaitmsec for softkeyboardhack="+defaultHackWaitmsec);window.scrollTo($.mobile.window.scrollLeft(),$.mobile.window.scrollTop());setTimeout(function(){(new n.Game).StartGame(!1)},defaultHackWaitmsec)});$("#cancelGame").click(function(){GameData=n.GetGameLocalStorage();gameObj=new n.Game;gameObj.IsGameInProgress()?n.confirmDialog("Cancel",'You\'re about to cancel the Game <span class="popupGameName">'+GameData.Name+"<\/span> that's in progress.<p>Are you sure?<\/p>",function(){n.CancelGame()}):n.CancelGame()});$("#reportGame").click(function(){n.DisplayReportPage()});console.log("END app.SetGamePlayerPrompt")};n.InitalizeGame=function(i){console.log("START app.InitalizeGame");t.GameId=i.Id;t.GameCode=i.Code;t.GameType=i.GameType;t.FirstName=h;t.LastName=h;t.NickName=h;t.Email=h;t.Sex=p.Male;t.PlayerId=h;t.GameQuestions=[];t.GameState=r.Idle;t.NbrPlayers=h;t.NbrPlayersRemaining=h;t.PlayerActive=!0;t.QuestionNbrSubmitted=c;t.ServerResponse=a;FindGameTimeCompleteInSecs=parseInt(n.GetConfigValue(f.Game,"FindGameTimeCompleteInSecs"));FirstQuestionTimeCompleteInSecs=parseInt(n.GetConfigValue(f.Game,"FirstQuestionTimeCompleteInSecs"));QuestionTimeCompleteInSecs=parseInt(n.GetConfigValue(f.Game,"QuestionTimeCompleteInSecs"));QuestionTimeWarningInSecs=parseInt(n.GetConfigValue(f.Game,nt));QuestionTimeSlopeInSecs=parseInt(n.GetConfigValue(f.Game,"QuestionTimeSlopeInSecs"));ServerClientTimeSyncInSecs=parseInt(n.GetConfigValue(f.Game,"ServerClientTimeSyncInSecs"));ClientDateSync=new Date;ServerDateSync=new Date(Date.parse(i.ServerNowDate));ServerClientDateDifInSecs=(ClientDateSync-ServerDateSync)/1e3;console.log("Date: Client="+ClientDateSync+" Server="+ServerDateSync+"DateDif="+ServerClientDateDifInSecs);Math.abs(ServerClientDateDifInSecs)<=ServerClientTimeSyncInSecs||ServerClientTimeSyncInSecs==0?StartDate=new Date(Date.parse(i.StartDate)):(StartDate=new Date(Date.parse(i.StartDate)),StartDate=new Date(StartDate.setSeconds(StartDate.getSeconds()+ServerClientDateDifInSecs)));console.log("Start Date="+GetInCommmonLocaleDateString(StartDate)+" "+GetInCommmonLocaleTimeString(StartDate));questionCount=0;decreaseForSlope=0;questionTimeCompleteDeltaInSecs=0;NextQuestionDeadlineDT=new Date(StartDate);NextQuestionDeadlineDT.setSeconds(NextQuestionDeadlineDT.getSeconds()+FindGameTimeCompleteInSecs);i.GameQuestions.forEach(function(n,r){t.GameQuestions[r]={};t.GameQuestions[r].QuestionId=n.Question.Id;t.GameQuestions[r].SelChoiceId=v;t.GameQuestions[r].Correct=!1;t.GameQuestions[r].Reason=v;i.GameType==u.LMS&&(questionCount++,questionCount==1?(decreaseForSlope=0,questionTimeCompleteDeltaInSecs=FirstQuestionTimeCompleteInSecs):questionCount==2?(decreaseForSlope=0,questionTimeCompleteDeltaInSecs=QuestionTimeCompleteInSecs):(decreaseForSlope+=QuestionTimeSlopeInSecs,questionTimeCompleteDeltaInSecs=QuestionTimeCompleteInSecs-decreaseForSlope),deltaToNextQuestionInSecs=questionTimeCompleteDeltaInSecs,QuestionDeadlineDT=new Date(NextQuestionDeadlineDT.setSeconds(NextQuestionDeadlineDT.getSeconds()+deltaToNextQuestionInSecs)),QuestionStartDT=questionCount==1?new Date(StartDate):new Date(new Date(QuestionDeadlineDT).setSeconds(QuestionDeadlineDT.getSeconds()-questionTimeCompleteDeltaInSecs)),QuestionWarningDT=new Date(new Date(QuestionDeadlineDT).setSeconds(QuestionDeadlineDT.getSeconds()-QuestionTimeWarningInSecs)),t.GameQuestions[r].QuestionDeadlineDT=new Date(QuestionDeadlineDT),t.GameQuestions[r].QuestionStartDT=new Date(QuestionStartDT),t.GameQuestions[r].QuestionWarningDT=new Date(QuestionWarningDT),NextQuestionDeadlineDT=QuestionDeadlineDT,console.log("QuesNbr="+r+" QuesStartDT="+GetInCommmonLocaleDateString(QuestionStartDT)+" "+GetInCommmonLocaleTimeString(QuestionStartDT)))});n.PutGameLocalStorage(i);n.PutResultLocalStorage(t);console.log("END app.InitalizeGame")};n.CreateGameTestPage=function(n){console.log("START app.CreateGameTestPage");testHtml="GameName:"+n.Name+"<br/>GameName:"+n.GameName+"<br/>Code:"+n.Code+"<br/>";n.GameQuestions.forEach(function(n,t){testHtml+="Question "+t+1+":"+n.Question.Text+"<br/>";n.Question.Choices.forEach(function(n,t){testHtml+="Choice "+t+1+":"+n.Text+"<br/>"})});page='<section id="testpage" data-role="page" data-title="Test Page" data-theme="a"><div data-role="header"><h1>Test Page<\/h1><\/div><article data-role="content">'+testHtml+"<\/article><\/section>";var t=$(page);t.appendTo($.mobile.pageContainer);$(":mobile-pagecontainer").pagecontainer("change",t,{transition:"none"});console.log("END app.CreateGameTestPage")};n.SetQuestionPage=function(i,r){console.log("START app.SetQuestionPage");$("footer").show();GameData=n.GetGameLocalStorage();t=n.GetResultLocalStorage();gameObj=new n.Game;gameObj.SetQuesInfo(i);question=GameData.GameQuestions[i].Question;questionText='<span class="bodyText">'+tt(question.Text)+"?<\/span>";fieldset='<fieldset data-role="controlgroup">';question.Choices.forEach(function(n){choiceText=tt(n.Text);choiceName=n.Name;selectChoiceId=n.Id;checkedStr="";t.GameQuestions[i].SelChoiceId==selectChoiceId&&(checkedStr=" checked");fieldset+='<input name="choice" id="choice-'+selectChoiceId+'" type="radio" data-theme="a"'+checkedStr+">";fieldset+='<label for="choice-'+selectChoiceId+'" data-theme="a">'+choiceText+"<\/label>"});fieldset+="<\/fieldset>";$("#questionText").html(questionText);$("#choiceList").html(fieldset);gameObj.SetQuesChoiceSensitivity();$('#question [data-role="controlgroup"]').css("margin",".5em 0");$("#question .ui-radio").css("margin","0");gameObj.SetQuesCorrectionStyle(i);gameObj.SetQuesNavigate(i);gameObj.SetQuesCountdown(i,!1);gameObj.RunQuesCountdownOnce(i);$("input[name ='choice']").on("change",function(){radioButtonSelectedID=$('input[name="choice"]:checked').attr("id");GameData=n.GetGameLocalStorage();gameObj=new n.Game;t.GameQuestions[e].SelChoiceId=radioButtonSelectedID.substr(7,radioButtonSelectedID.length-6);n.PutResultLocalStorage(t);gameObj.SetBottomNavButtons(!0,!0,!0,!0);gameObj.AlertPlayerComplete(e,GameData.GameQuestions.length-1)});gameObj.SetBottomNavButtons(!0,!0,!0,!0);$(":mobile-pagecontainer").pagecontainer("change","#question",{transition:r});styleHomeMinHeight=parseInt($("#home").css("min-height"));styleQuesMinHeight=parseInt($("#question").css("min-height"));console.log("homeMinHeight: "+styleHomeMinHeight+"  questMinHeight: "+styleQuesMinHeight);styleQuesMinHeight<styleHomeMinHeight&&(console.log("set HOME min-height"),$("#question").css("min-height",styleHomeMinHeight));$("#question header").css("position","fixed");$("#question footer").css("position","fixed");$(window).trigger("resize");console.log("END app.SetQuestionPage")};n.SetSummaryPage=function(){for(console.log("START app.SetSummaryPage"),$("footer").show(),GameData=n.GetGameLocalStorage(),t=n.GetResultLocalStorage(),gameObj=new n.Game,summaryText='<span class="bodyText">Questions - '+n.NbrQuestionsAnswered()+" out of "+gameObj.NbrQuestions()+" answered<\/span>",listViewHtml='<ul data-role="listview" data-inset="true">',index=0;index<gameObj.NbrQuestions();index++)value=tt(GameData.GameQuestions[index].Question.Text),listViewHtml+="<li"+(t.GameQuestions[index].SelChoiceId==v?' data-icon="alert" ':' data-icon="check" ')+" data-qnum="+index+'><a href="#">'+(index+1)+". "+value+"?<\/a><\/li>";listViewHtml+="<\/ul>";$("#summaryText").html(summaryText);$("#questionList").html(listViewHtml);$("#questionList").listview().trigger("create");$("#summary article").css("overflow","hidden");$("[data-qnum]").click(function(){e=parseInt(this.attributes["data-qnum"].value);n.SetQuestionPage(e,"none")});gameObj.SetBottomNavButtons(!1,!1,!0,!1);$(":mobile-pagecontainer").pagecontainer("change","#summary");$("#summary header").css("position","fixed");$("#summary footer").css("position","fixed");$(window).trigger("resize");console.log("END app.SetSummaryPage")};n.BindPageStaticEvents=function(i){console.log("START app.BindPageStaticEvents");switch(i){case"#home":$('[data-game="active"]').click(function(){index=this.attributes["data-index"].value;index!=-1&&(n.PopQueueGames(),GameData=n.GetGameLocalStorage(),t=n.GetResultLocalStorage());n.ResumeGame(t.GameState)});$('[data-game="submitted"] .gameResumeAction').click(function(){$.mobile.loading("show");index=this.attributes["data-index"].value;setTimeout(function(){n.GameResumeAction(index)},500)});$('[data-game="submitted"] .gameReportAction').click(function(){$.mobile.loading("show");index=this.attributes["data-index"].value;setTimeout(function(){n.GameReportAction(index)},500)});$('[data-game="active"] .gameReportAction').click(function(){$.mobile.loading("show");index=this.attributes["data-index"].value;setTimeout(function(){n.GameReportAction(index)},500)});break;case"#question":$(".backButton").click(function(){(new n.Game).BackButtonHandler()});$(".summaryButton").click(function(){n.SetSummaryPage()});$(".nextButton").click(function(){(new n.Game).NextButtonHandler()});break;case"#summary":$(".submitButton").click(function(){n.confirmDialog("Submit",(new n.Game).ProcessMessage(ii),function(){n.SetQuestionChoicesSensitivity(!1);$.mobile.loading("show");setTimeout(function(){n.ConfirmSubmit()},1e3*d)})});break;case"misc":$('[data-icon="home"]').click(function(){$("#menu").panel("close");n.SetHomePageStyle(!1);n.SetHomePageInitialDisplay();$(":mobile-pagecontainer").pagecontainer("change","#home")});$("[data-icon='plus'],#newGame").click(function(){n.GameAddAction()});$("[data-icon='minus']").click(function(){if(n.IsGameInProgress()||n.IsGamesInQueue(r.Active))n.IsGamesInQueue(r.Active)&&n.PopQueueGames(),GameData=n.GetGameLocalStorage(),t=n.GetResultLocalStorage(),n.confirmDialog("Cancel",'You\'re about to cancel the Game <span class="popupGameName">'+GameData.Name+" ("+n.GetPlayerName()+")<\/span> that's in progress.<p>Are you sure?<\/p>",function(){n.CancelGame()});else{n.popUpHelper("Error","There's no Game in progress",null);return}});$("[data-icon='book']").click(function(){n.DisplayAboutPage()});$('#tablereport header [data-icon="back"]').click(function(){window.history.go(-1);$("#chartreport header").css("position","fixed");$("#chartreportback header").css("position","fixed");$("#tablereport header").css("position","fixed")});$('#chartreportback header [data-icon="back"]').click(function(){window.history.go(-1);$("#chartreport header").css("position","fixed");$("#chartreportback header").css("position","fixed")});$("#playerConsoleText").tap(function(){$("#qCountdown").length>0&&$("#popupCountdownParent").enhanceWithin().popup().popup("open",{transition:"flip"})})}console.log("END app.BindPageStaticEvents")};n.GameAddAction=function(){if(console.log("START app.GameAddAction"),gameObj=new n.Game,$("#menu").panel("close"),gameObj.IsGameInProgress()){GameData=n.GetGameLocalStorage();n.popUpHelper("Error","Game '"+GameData.Name+"' is in progress","You must cancel this game first to start a new game.");return}if(n.IsGamesInQueue(r.Active)){GameListQueue=n.GetGameListQueueLocalStorage();index=n.GetActiveGameIndexInQueue();n.popUpHelper("Error","Game '"+GameListQueue[index].Name+"' is in progress","You must cancel this game first to start a new game.");return}$("[data-icon='plus']").addClass("ui-disabled");$("[data-icon='minus']").removeClass("ui-disabled");n.SetHomePageStyle(!1);n.SetGameCodePrompt();gameObj.SetGameState(r.Idle);$(":mobile-pagecontainer").pagecontainer("change","#home");console.log("END app.GameAddAction")};n.GameResumeAction=function(i){console.log("START app.GameResumeAction");n.SetCurrentGameData(i);t=n.GetResultLocalStorage();n.GetGameStatusServer("GameStatusResponseForGameResumeAction",t.GameCode);console.log("END app.GameResumeAction")};n.CompleteGameResumeAction=function(t,i,u){console.log("START app.CompleteGameResumeAction");$.mobile.loading("hide");u==undefined?((new n.Game).SetGameState(r.ReadOnly),n.SetHomePageStyle(!1),n.ResumeGame(r.ReadOnly)):n.popUpHelper("Error","GetGameStatusServer: "+u);console.log("END app.CompleteGameResumeAction")};n.GameReportAction=function(i){console.log("START app.GameReportAction");i!=-1&&n.SetCurrentGameData(i);t=n.GetResultLocalStorage();n.GetGameStatusServer("GameStatusResponseForGameReportAction",t.GameCode);console.log("END app.GameReportAction")};n.CompleteGameReportAction=function(t,i,r){console.log("START app.CompleteGameReportAction");$.mobile.loading("hide");r==undefined?t?n.DisplayReportPage():n.popUpHelper("Info","The game organizer has not made game results accessible to the players yet."):n.popUpHelper("Error","GetGameStatusServer: "+r);console.log("END app.CompleteGameReportAction")};n.SetCurrentGameData=function(i){console.log("START app.SetCurrentGameData");GameQueueBeforPush=n.GetGameQueueLocalStorage();ResultQueueBeforePush=n.GetResultLocalStorage();GameDataBeforePush=GameQueueBeforPush[i].Game;resultBeforePush=GameQueueBeforPush[i].Result;gameConfigBeforePush=GameQueueBeforPush[i].GameConfig;(new n.Game).IsGameInProgress()&&n.PushQueueGames(t.GameState);n.PutGameLocalStorage(GameDataBeforePush);n.PutResultLocalStorage(resultBeforePush);gameConfigBeforePush!=undefined&&n.PutGameConfigLocalStorage(gameConfigBeforePush);console.log("END app.SetCurrentGameData")};n.ConfirmSubmit=function(){console.log("START app.ConfirmSubmit");b=!0;gameObj=new n.Game;console.log("test deadline in ConfirmSubmit");gameObj.IsNewQuestionDeadlineNotPassed()&&t.PlayerActive&&(console.log("new question deadline not passed and player is still active - keep setting up submit"),gameObj.SetClockCountdownEnable("qdeadline",!1),n.PostGameAnswersServer(),console.log("completed app.PostGameAnswersServer"));$.mobile.loading("hide");b=!1;console.log("End - app.ConfirmSubmit")};n.CompleteConfirmSubmit=function(t){console.log("START app.CompleteConfirmSubmit");gameObj=new n.Game;gameObj.SetClockCountdownEnable("qdeadline",!1);gameObj.ResetLocalNotifications();gameObj.IsGameSubmit()&&n.SubmitSuccess();gameObj.NavigateAfterGAResponse();$.mobile.loading("hide");gameObj.ProcessMessageForGAResponse(t);b=!1;console.log("End - app.CompleteConfirmSubmit")};n.SubmitSuccess=function(){console.log("START app.SubmitSuccess");t=n.GetResultLocalStorage();n.PutResultLocalStorage(t);gameObj=new n.Game;gameObj.SetGameStatePostSubmit();o==r.ReadOnly&&gameObj.SetGamePostSubmit(o);console.log("END app.SubmitSuccess")};n.AdjustPagePaddingTop=function(){console.log("START AdjustPagePaddingTop");paddingtop="44px";paddingbottom="58px";badPaddingThreshold=30;lt||$.mobile.pageContainer.pagecontainer("getActivePage").attr("id")=="home"&&parseInt($("#home").css("padding-top"))<badPaddingThreshold&&($("#home").css("padding-top",paddingtop),lt=!0,console.log("change the padding to "+paddingtop));console.log("END AdjustPagePaddingTop")};n.SetHeaderImage=function(){console.log("START SetHeaderImage");width=$(window).width();height=$(window).height();height>=2560?$("header img").attr("src","./images/header/header432x40.png"):height<=2559&&height>=1912?$("header img").attr("src","./images/header/header324x40.png"):height<=1911&&height>=1600?$("header img").attr("src","./images/header/header270x40.png"):height<=1599&&height>=1180?$("header img").attr("src","./images/header/header240x40.png"):height<=1179&&height>=1024?$("header img").attr("src","./images/header/header180x40.png"):height<=1023&&height>=800?$("header img").attr("src","./images/header/header180x40.png"):height<=799&&height>=480?$("header img").attr("src","./images/header/header180x40.png"):height<=479&&height>=0&&$("header img").attr("src","./images/header/header144x40.png");console.log("END SetHeaderImage")};n.SetHomePageStyle=function(){console.log("START app.SetHomePageStyle");$("footer").hide();(new n.Game).SetBottomNavButtons(!1,!1,!1,!1);console.log("END app.SetHomePageStyle")};n.CancelGame=function(){console.log("START app.CancelGame");(new n.Game).StopClockCountdown();$("#menu").panel("close");(new n.Game).ResetLocalNotifications();localStorage.removeItem("Game");localStorage.removeItem("Result");n.SetHomePageStyle(!0);$("#homePageContent").html("");$("#homePageContent").trigger("create");n.EnableNewGame();n.SetHomePageInitialDisplay();$(":mobile-pagecontainer").pagecontainer("change","#home",{transition:"none"});console.log("END app.CancelGame")};n.EnableNewGame=function(){console.log("START app.EnableNewGame");$("[data-icon='plus']").removeClass("ui-disabled");$("[data-icon='minus']").addClass("ui-disabled");(new n.Game).SetGameState(r.Idle);console.log("END app.EnableNewGame")};n.ResumeGame=function(t){console.log("START app.ResumeGame");(new n.Game).SetGameState(t);n.SetGamePlayerPrompt();console.log("END app.ResumeGame")};n.DisplayAboutPage=function(){console.log("START app.DisplayAboutPage");dateTimeToCache=new Date(vt.valueOf());dateTimeToCache.setMinutes(dateTimeToCache.getMinutes()+at);var t=new Date;t>dateTimeToCache||$("#aboutContent").length==0?($(":mobile-pagecontainer").pagecontainer("change","#about",{transition:"none"}),n.GetInCommonConfigServer(),vt=new Date(t.valueOf())):$(":mobile-pagecontainer").pagecontainer("change","#about",{transition:"none"});console.log("END app.DisplayAboutPage")};n.LoadGoogleChartLibs=function(){console.log("START app.LoadGoogleChartLibs");var n=document.createElement("script");n.type="text/javascript";n.src="https://www.google.com/jsapi";document.getElementsByTagName("head")[0].appendChild(n);setTimeout(function(){google.load("visualization","1",{packages:["corechart","table"]})},2e3);console.log("END app.LoadGoogleChartLibs")};n.DisplayReportPage=function(){console.log("START app.DisplayReportPage");GameData=n.GetGameLocalStorage();t=n.GetResultLocalStorage();typeof google!="undefined"?GameData.GameType==u.Match?t.PlayerCount>=2?($("footer").hide(),n.DrawReport(s.MatchSummary,t.GameId,t.GameCode,t.PlayerId,0,0)):n.popUpHelper("Info","There are not enough players that have submitted their games to report on the results. Please try again later."):GameData.GameType==u.Test?($("footer").hide(),n.DrawReport(s.TestDetail,t.GameId,t.GameCode,t.PlayerId,0,0)):GameData.GameType==u.LMS&&($("footer").hide(),n.DrawReport(s.GameLMSSummary,t.GameId,t.GameCode,t.PlayerId,0,0)):n.confirmDialog("Error",'Your device must be connected to display results.<br/><span style="color: #00edf0">Is your device connected now?<\/span><i> (you may have to confirm/retry a couple of times)<\/i>',function(){location.reload(!0)});console.log("END app.DisplayReportPage")};n.DrawReport=function(t,i,r,u,f,e){console.log("START app.DrawReport");switch(t){case s.MatchSummary:url=pt+i+"/"+r+"/"+u;$(":mobile-pagecontainer").pagecontainer("change","#chartreport",{transition:"none"});console.log("START app.DrawPlayerMatchSummary AJAX url:"+url);break;case s.MatchDetail:url=wt+i+"/"+r+"/"+u+"/"+f;$(":mobile-pagecontainer").pagecontainer("change","#tablereport",{transition:"none"});console.log("START app.DrawPlayerMatchDetail AJAX url:"+url);break;case s.TestDetail:url=bt+i+"/"+r+"/"+u;$(":mobile-pagecontainer").pagecontainer("change","#tablereport",{transition:"none"});console.log("START app.DrawPlayerTestDetail AJAX url:"+url);break;case s.GameLMSSummary:url=kt+i+"/"+r;$(":mobile-pagecontainer").pagecontainer("change","#chartreport",{transition:"none"});console.log("START app.DrawGameLMSSummary AJAX url:"+url);break;case s.PlayerLMSSummary:url=dt+i+"/"+r+"/"+e;$(":mobile-pagecontainer").pagecontainer("change","#chartreportback",{transition:"none"});console.log("START app.DrawPlayerLMSSummary AJAX url:"+url);break;case s.LMSDetail:url=gt+i+"/"+r+"/"+u;$(":mobile-pagecontainer").pagecontainer("change","#tablereport",{transition:"none"});console.log("START app.DrawPlayerLMSDetail AJAX url:"+url)}$.mobile.loading("show");$.getJSON(url).done(function(i){if(i.errorid==undefined){var r=!1;$("parent_chart_div").css("min-height:500px;height: 100%;width: 100%;margin:auto;background:#fff;text-align:center");$("chart_div").css("min-height:500px;height: 100%;width: 100%;margin:auto;background:#fff;text-align:center");$(window).off("resize");switch(t){case s.MatchSummary:$(window).resize(function(){console.log("resize ReportType.MatchSummary");console.log("MatchSummary-Resize: "+$.mobile.pageContainer.pagecontainer("getActivePage").attr("id"));n.SetHeaderImage();$.mobile.pageContainer.pagecontainer("getActivePage").attr("id")=="chartreport"&&(r=!0,n.RenderPlayerMatchSummary(i))});$("#chartreport #chart_div").html("");n.RenderPlayerMatchSummary(i);break;case s.MatchDetail:$(window).resize(function(){console.log("MatchDetail-Resize: "+$.mobile.pageContainer.pagecontainer("getActivePage").attr("id"));n.SetHeaderImage();$.mobile.pageContainer.pagecontainer("getActivePage").attr("id")=="tablereport"&&(r=!0,n.RenderPlayerMatchDetail(i))});$("#table_div").html("");n.RenderPlayerMatchDetail(i);break;case s.TestDetail:$(window).resize(function(){console.log("TestDetail-Resize: "+$.mobile.pageContainer.pagecontainer("getActivePage").attr("id"));n.SetHeaderImage();$.mobile.pageContainer.pagecontainer("getActivePage").attr("id")=="tablereport"&&(r=!0,n.RenderPlayerTestDetail(i))});$("#table_div").html("");n.RenderPlayerTestDetail(i);break;case s.GameLMSSummary:$(window).resize(function(){console.log("GameLMSSummary-Resize: "+$.mobile.pageContainer.pagecontainer("getActivePage").attr("id"));n.SetHeaderImage();$.mobile.pageContainer.pagecontainer("getActivePage").attr("id")=="tablereport"&&(r=!0,n.RenderGameLMSSummary(i))});$("#chartreport #chart_div").html("");n.RenderGameLMSSummary(i);break;case s.PlayerLMSSummary:$(window).resize(function(){console.log("PlayerLMSSummary-Resize: "+$.mobile.pageContainer.pagecontainer("getActivePage").attr("id"));n.SetHeaderImage();$.mobile.pageContainer.pagecontainer("getActivePage").attr("id")=="tablereport"&&(r=!0,n.RenderPlayerLMSSummary(i))});$("#chartreportback #chart_div").html("");n.RenderPlayerLMSSummary(i);break;case s.LMSDetail:$(window).resize(function(){console.log("LMSDetail-Resize: "+$.mobile.pageContainer.pagecontainer("getActivePage").attr("id"));n.SetHeaderImage();$.mobile.pageContainer.pagecontainer("getActivePage").attr("id")=="tablereport"&&(r=!0,n.RenderPlayerLMSDetail(i))});$("#table_div").html("");n.RenderPlayerLMSDetail(i)}$.mobile.loading("hide")}else $.mobile.loading("hide"),errorMessage="There was an In Common server connection error.",n.popUpHelper("Error",errorMessage,"Please try again.")}).fail(function(t,i,r){$.mobile.loading("hide");n.popUpHelper("Error",n.GetAJAXFailureErrMessage("Reporting",i,r),null)});console.log("END app.DrawReport")};n.RenderUpperLeftBtn=function(n,t){console.log("START app.RenderUpperLeftBtn");idStr="#chartUpperLeftButton";n!="chart"&&(idStr="#tableUpperLeftButton");$("idStr").each(function(){var n=$.map(this.attributes,function(n){return n.name}),t=$(this);$.each(n,function(n,t){$("idStr").removeAttr(t)})});t?($(idStr).attr("href","#home"),$(idStr).attr("data-icon","home"),$(idStr).attr("data-iconpos","notext"),$(idStr).text("Home")):($(idStr).attr("href","#"),$(idStr).attr("data-icon","back"),$(idStr).attr("data-iconpos","notext"),$(idStr).text("Return"));console.log("END app.RenderUpperLeftBtn")};n.RenderPlayerMatchSummary=function(i){var u,r,o,h,e,f;console.log("START RenderPlayerMatchSummary");GameData=n.GetGameLocalStorage();t=n.GetResultLocalStorage();selectHandler=function(){var r,u;console.log("selectHandler");r=f.getSelection()[0];r&&(u=i[r.row].Id,console.log("The player selected "+u),n.DrawReport(s.MatchDetail,t.GameId,t.GameCode,t.PlayerId,u,0))};try{for($("#chartreport #chartheader").html('<span class="reportLabel">Game :<\/span> <span class="reportLabelText">'+GameData.Name+'<\/span><br/><span class="reportLabel reportLabelMargin">Player:<\/span> <span class="reportLabelText">'+n.GetPlayerName())+"<\/span>",maxTickValue=0,u=new Array(i.length+1),u[0]=new Array(4),u[0][0]="Player",u[0][1]="Matches",u[0][2]={role:"annotation"},u[0][3]={role:"style"},r=0;r<i.length;r++)u[r+1]=new Array(3),u[r+1][0]=i[r].Name,u[r+1][1]=i[r].Value,legendStr="("+i[r].Value+")",legendStr=i[r].Name+"("+i[r].Value+")",u[r+1][2]=legendStr,u[r+1][3]="color: #262626",maxTickValue=Math.max(maxTickValue,i[r].Value);o=google.visualization.arrayToDataTable(u);h="# Matches out of "+(new n.Game).NbrQuestions();tickArray=GetChartAxisTickets(0,maxTickValue,4);e={};e={height:Math.round(90*i.length),chartArea:{left:10,top:25,right:10,width:"95%",height:"75%"},colors:["#262626"],hAxis:{title:h,format:"#",titleTextStyle:{fontSize:"20"},ticks:tickArray},backgroundColor:"transparent",bar:{groupWidth:"75%"},annotations:{textStyle:{fontName:"Times-Roman",fontSize:13,bold:!0,italic:!0,opacity:.8}},legend:{position:"top",alignment:"end",textStyle:{color:"black",fontSize:16}}};f=new google.visualization.BarChart($("#chartreport #chart_div")[0]);google.visualization.events.addListener(f,"select",selectHandler);f.draw(o,e);console.log("END func RenderPlayerMatchSummary")}catch(c){n.popUpHelper("Error",n.GetGoogleChartFailureErrMessage("Chart Player Match Summary",c),null)}console.log("END RenderPlayerMatchSummary")};n.RenderPlayerMatchDetail=function(i){var u,r,e,f;console.log("START RenderPlayerMatchDetail");GameData=n.GetGameLocalStorage();t=n.GetResultLocalStorage();setColumnWidths=function(){$(window).width()<=900&&($('.googleReportTableHeader:contains("%")').css("width","30px"),$('.googleReportTableHeader:contains("Matchup Choice")').css("width","50px"))};try{for(i.length>=1&&$("#tableheader").html('<span class="reportLabel" style="margin-right: 20px">Game<\/span>: <span class="reportLabelText">'+GameData.Name+'<\/span><br/><span class="reportLabel" style="margin-right: 17px">Player<\/span>: <span class="reportLabelText">'+i[0].PlayerName+'<\/span><br/><span class="reportLabel reportLabelMargin">Matchup:<\/span> <span class="reportLabelText">'+i[0].MatchedPlayerName)+"<\/span>",u=new google.visualization.DataTable,u.addColumn("string","Question"),u.addColumn("string","Player Choice"),u.addColumn("string","Matchup Choice"),u.addColumn("number","%"),rowlength=4,rowVector=new Array(rowlength),matchCount=0,r=0;r<i.length;r++)cellClassName="googleReportCellNOWB",i[r].Match==1?(cellClassName="googleReportCellYESWB",matchCount++):cellClassName="googleReportCellNOWB",row=0,rowVector[row++]={v:i[r].Question,p:{className:"googleReportCell"}},rowVector[row++]={v:i[r].PlayerChoice,p:{className:"googleReportCellWB"}},rowVector[row++]={v:i[r].MatchedPlayerChoice,p:{className:cellClassName}},rowVector[row++]={v:i[r].PercentChosen,p:{className:"googleReportCell"}},u.addRow(rowVector);$(".tableHeader").html(matchCount+" Matches out of "+i.length+" Questions");e={allowHtml:!0,alternatingRowStyle:!0,cssClassNames:{headerCell:"googleReportTableHeader",tableCell:"googleReportTableNonHeader",tableRow:"googleReportTableNonHeader"},backgroundColor:"transparent"};f=new google.visualization.Table(document.getElementById("table_div"));google.visualization.events.addListener(f,"ready",setColumnWidths);f.draw(u,e);n.AlignTableCellContent()}catch(o){n.popUpHelper("Error",n.GetGoogleChartFailureErrMessage("Chart Player Match Detail",o),null)}console.log("END RenderPlayerMatchDetail")};n.RenderPlayerTestDetail=function(i){var u,r,e,f;console.log("START RenderPlayerTestDetail");GameData=n.GetGameLocalStorage();t=n.GetResultLocalStorage();selectHandler=function(){console.log("selectHandler")};try{for(i.length>=1&&$("#tableheader").html('<span class="reportLabel">Game<\/span> : <span class="reportLabelText">'+GameData.Name+'<\/span><br/><span class="reportLabel reportLabelMargin">Player:<\/span> <span class="reportLabelText">'+i[0].PlayerName+'<\/span> <span class="reportLabel reportLabelMargin">Score:<\/span> '+CalcTestScore(i)+"%"),u=new google.visualization.DataTable,u.addColumn("string","Question"),u.addColumn("string","Selections"),u.addColumn("string","Correct Choices"),rowlength=3,rowVector=new Array(rowlength),correctCount=0,r=0;r<i.length;r++)cellClassName="googleReportCellNOWB",i[r].QuestionCorrect==1?(cellClassName="googleReportCellYESWB",correctCount++):cellClassName="googleReportCellNOWB",row=0,rowVector[row++]={v:i[r].Question,p:{className:"googleReportCell"}},rowVector[row++]={v:i[r].SelectedChoices,p:{className:cellClassName}},rowVector[row++]={v:i[r].CorrectChoices,p:{className:"googleReportCellWB"}},u.addRow(rowVector);$(".tableHeader").html(correctCount+" Correct out of "+i.length+" Questions");e={allowHtml:!0,cssClassNames:{headerCell:"googleReportTableHeader",tableCell:"googleReportTableNonHeader",tableRow:"googleReportTableNonHeader"}};f=new google.visualization.Table(document.getElementById("table_div"));google.visualization.events.addListener(f,"select",selectHandler);f.draw(u,e);n.AlignTableCellContent()}catch(o){n.popUpHelper("Error",n.GetGoogleChartFailureErrMessage("Chart Player Test Detail",o),null)}console.log("END RenderPlayerTestDetail")};n.RenderGameLMSSummary=function(i){var r,u;console.log("START RenderGameLMSSummary");GameData=n.GetGameLocalStorage();t=n.GetResultLocalStorage();selectHandler=function(){var r,i;console.log("selectHandler");r=u.getSelection()[0];r&&(i=0,r.row==1?i=1:r.row==2&&(i=2),console.log("The player selected "+i),n.DrawReport(s.PlayerLMSSummary,t.GameId,t.GameCode,0,0,i))};try{$("#chartreport #charttitle").html("Game LMS Summary");switch(i.GameStatus){case yi:statusText="Unknown";break;case pi:statusText="Not Started";break;case wi:statusText=i.MaxQuestionNbrSubmitted!=ut?"Started":"Started - No Submissions Yet";break;case bi:statusText="Active";break;case ki:statusText="Suspended";break;case di:statusText="Completed"}if(i.MostRecentQuestionNbrDeadlinePassed!=ut?(mostRecentQuestionNbrDeadlinePassed=i.MostRecentQuestionNbrDeadlinePassed+1,dateMostRecentDeadline=new Date(i.MostRecentQuestionDeadlinePassed),mostRecentQuestionDeadlinePassed=GetInCommmonLocaleDateString(dateMostRecentDeadline)+" "+GetInCommmonLocaleTimeString(dateMostRecentDeadline)):(mostRecentQuestionNbrDeadlinePassed="None",mostRecentQuestionDeadlinePassed="None"),$("#chartreport #chartheader").html('<span class="reportLabel">Game:<\/span> <span class="reportLabelText">'+GameData.Name+'<\/span><span class="reportLabel" style="margin-left:23px">Status:<\/span> <span class="reportLabelText">'+statusText+'<\/span><br/><span class="reportLabel">Question# Deadline Passed: <\/span> <span class="reportLabelText">'+mostRecentQuestionNbrDeadlinePassed+'<\/span><br/><span class="reportLabel">Deadline:<\/span> <span class="reportLabelText">'+mostRecentQuestionDeadlinePassed+"<\/span>"),i.NbrPlayers==0){$("#chart_div").html('<br/><br/><span class="reportNoDataText">No players have played this LMS game yet<\/span>');return}r=new Array(4);r[0]=new Array(4);r[0][0]="Status";r[0][1]="# of Players";r[0][2]={role:"annotation"};r[0][3]={role:"style"};legendStrTotal="";legendStrActive="";legendStrInactive="";r[1]=new Array(3);r[1][0]="All";r[1][1]=i.NbrPlayers;legendStrTotal=i.NbrPlayers>0?"("+i.NbrPlayers+")":"";r[1][2]=legendStrTotal;r[1][3]="#000000";r[2]=new Array(3);r[2][0]="Standing";r[2][1]=i.NbrPlayersActive;legendStrActive=i.NbrPlayersActive>0?"("+i.NbrPlayersActive+")":"";r[2][2]=legendStrActive;r[2][3]="#00ff00";r[3]=new Array(3);r[3][0]="Sitting";r[3][1]=i.NbrPlayersInactive;legendStrInactive=i.NbrPlayersInactive>0?"("+i.NbrPlayersInactive+")":"";r[3][2]=legendStrInactive;r[3][3]="#ff0000";var e=google.visualization.arrayToDataTable(r),f={};f={isStacked:!0,height:Math.round(360),chartArea:{left:75,top:10,width:"80%",height:"80%"},colors:["#262626"],vAxis:{title:"Player Status",titleTextStyle:{fontSize:"15"}},hAxis:{title:"#Questions Submitted",format:"#",titleTextStyle:{fontSize:"15"}},backgroundColor:"transparent",bar:{groupWidth:"80%"},legend:{position:"top",alignment:"end",textStyle:{color:"red",fontSize:16}}};u=new google.visualization.BarChart($("#chartreport #chart_div")[0]);google.visualization.events.addListener(u,"select",selectHandler);u.draw(e,f);console.log("END func RenderGameLMSSummary")}catch(o){n.popUpHelper("Error",n.GetGoogleChartFailureErrMessage("Chart Game LMS Summary",o),null)}console.log("END RenderGameLMSSummary")};n.RenderPlayerLMSSummary=function(i){var u,r,o,h,e,f;console.log("START RenderPlayerLMSSummary");GameData=n.GetGameLocalStorage();t=n.GetResultLocalStorage();selectHandler=function(){var r,u;console.log("selectHandler");r=f.getSelection()[0];r&&(u=i[r.row].PlayerId,console.log("The player selected "+u),n.DrawReport(s.LMSDetail,t.GameId,t.GameCode,u,0,0))};try{for($("#chartreportback #charttitle").html("Player LMS Summary"),maxTickValue=0,nbrAnswersCorrect=0,nbrAnswersIncorrect=0,nbrAnswersNotOntime=0,maxSubmittedQuestionNbr=0,u=new Array(i.length+1),u[0]=new Array(4),u[0][0]="Player",u[0][1]="Correct",u[0][2]={role:"annotation"},u[0][3]="Incorrect",u[0][4]={role:"annotation"},u[0][5]="Late",u[0][6]={role:"annotation"},r=0;r<i.length;r++)u[r+1]=new Array(3),u[r+1][0]=i[r].PlayerName,i[r].PlayerStatus?(nbrAnswersCorrect=i[r].QuestionNbrLastSubmitted+1,nbrAnswersIncorrect=0,nbrAnswersNotOntime=0):i[r].PlayerGameReason==et?(nbrAnswersCorrect=i[r].QuestionNbrLastSubmitted,nbrAnswersIncorrect=1,nbrAnswersNotOntime=0):i[r].PlayerGameReason==y?(nbrAnswersCorrect=i[r].QuestionNbrLastSubmitted+1,nbrAnswersIncorrect=0,nbrAnswersNotOntime=1):(nbrAnswersCorrect=i[r].QuestionNbrLastSubmitted,nbrAnswersIncorrect=1,nbrAnswersNotOntime=0),maxSubmittedQuestionNbr=Math.max(maxSubmittedQuestionNbr,nbrAnswersCorrect+nbrAnswersIncorrect+nbrAnswersNotOntime),u[r+1][1]=nbrAnswersCorrect,u[r+1][2]=nbrAnswersCorrect>0?"("+nbrAnswersCorrect+")":"",u[r+1][3]=nbrAnswersIncorrect,u[r+1][4]=nbrAnswersIncorrect>0?"("+nbrAnswersIncorrect+")":"",u[r+1][5]=nbrAnswersNotOntime,u[r+1][6]=nbrAnswersNotOntime>0?"("+nbrAnswersNotOntime+")":"",maxTickValue=Math.max(maxTickValue,i[r].QuestionNbrLastSubmitted+1);mostRecentQuestionDeadlinePassed=new Date(i[0].MostRecentQuestionDeadlinePassed);mostRecentQuestionDeadlinePassedV=mostRecentQuestionDeadlinePassed.getTime()!=gi?GetInCommmonLocaleDateString(mostRecentQuestionDeadlinePassed)+" "+GetInCommmonLocaleTimeString(mostRecentQuestionDeadlinePassed):"None";$("#chartreportback #chartheader").html('<span class="reportLabel">Game:<\/span> <span class="reportLabelText">'+GameData.Name+'<\/span><br/><span class="reportLabel">#Ques Submitted:<\/span> <span class="reportLabelText">'+maxSubmittedQuestionNbr+'<\/span> <\/br><span class="reportLabel">Last Ques Dead:<\/span> <span class="reportLabelText">'+mostRecentQuestionDeadlinePassedV+"<\/span>");o=google.visualization.arrayToDataTable(u);h="#Questions Submitted";tickArray=GetChartAxisTickets(0,maxTickValue,4);e={};e={height:Math.round(67*i.length+150),chartArea:{left:75,top:25,width:"80%",height:"75%"},colors:["#00ff00","#ff0000","#000000"],vAxis:{title:"Players",titleTextStyle:{fontSize:"15"},textStyle:{fontSize:"10"}},hAxis:{title:h,format:"#",titleTextStyle:{fontSize:"15"},ticks:tickArray},backgroundColor:"transparent",bar:{groupWidth:"75%"},isStacked:!0,legend:{position:"top",alignment:"end",textStyle:{fontSize:11}}};f=new google.visualization.BarChart($("#chartreportback #chart_div")[0]);google.visualization.events.addListener(f,"select",selectHandler);f.draw(o,e);console.log("END func RenderPlayerLMSSummary")}catch(c){n.popUpHelper("Error",n.GetGoogleChartFailureErrMessage("Chart Game LMS Summary",c),null)}console.log("END RenderPlayerLMSSummary")};n.RenderPlayerLMSDetail=function(i){var u,r,e,f;console.log("START RenderPlayerLMSDetail");GameData=n.GetGameLocalStorage();t=n.GetResultLocalStorage();selectHandler=function(){var n,t;console.log("selectHandler");n=chart.getSelection()[0];n&&(t=i[n.row].QuestionId,console.log("The question selected "+t))};try{for($("#tabletitle").html("Player LMS Detail"),u=new google.visualization.DataTable,u.addColumn("string","Question"),u.addColumn("string","Selections"),u.addColumn("string","Correct Choices"),rowlength=3,rowVector=new Array(rowlength),correctCount=0,r=0;r<i.length;r++)cellClassName="googleReportCellNOWB",i[r].SelectedChoices!=null&&i[r].SelectedChoices==i[r].CorrectChoices?(cellClassName="googleReportCellYESWB",correctCount++):cellClassName="googleReportCellNOWB",question=i[r].Question,selectedChoices=i[r].SelectedChoices!=null?i[r].SelectedChoices:"ANSWER NOT SUBMITTED",CorrectChoices=i[r].CorrectChoices,row=0,rowVector[row++]={v:question,p:{className:"googleReportCell"}},rowVector[row++]={v:selectedChoices,p:{className:cellClassName}},rowVector[row++]={v:CorrectChoices,p:{className:"googleReportCellWB"}},u.addRow(rowVector);$(".tableHeader").html(correctCount+" Correct out of "+i.length+" Questions");e={allowHtml:!0,alternatingRowStyle:!0,cssClassNames:{headerCell:"googleReportTableHeader",tableCell:"googleReportTableNonHeader",tableRow:"googleReportTableNonHeader"},backgroundColor:"transparent"};i.length>=1&&$("#tableheader").html('<span class="reportLabel">Game:<\/span> <span class="reportLabelText">'+GameData.Name+'<\/span><br/><span class="reportLabel reportLabelMargin">Player: <\/span><span class="reportLabelText">'+i[0].PlayerName+'<\/span><br/><span class="reportLabel reportLabelMargin">#Questions Correct: <\/span><span class="reportLabelText">'+correctCount+"<\/span>");f=new google.visualization.Table(document.getElementById("table_div"));google.visualization.events.addListener(f,"select",selectHandler);f.draw(u,e);n.AlignTableCellContent();console.log("END func RenderPlayerLMSDetail")}catch(o){n.popUpHelper("Error",n.GetGoogleChartFailureErrMessage("Table Player LMS Detail",o),null)}console.log("END RenderPlayerLMSDetail")};n.IsContentToChart=function(n){return console.log("START app.IsContentToChart"),contentToChart=!1,n!=0&&n!=1&&n!=2&&(contentToChart=!0),console.log("END app.IsContentToChart"),contentToChart};n.AlignTableCellContent=function(){console.log("START app.AlignTableCellContent");$(".googleReportTableHeader").css("vertical-align","top");$(".googleReportCellYES").css("vertical-align","top");$(".googleReportCellNO").css("vertical-align","top");$(".googleReportCell").css("vertical-align","top");$(".googleReportCellYESWB").css("vertical-align","top");$(".googleReportCellNOWB").css("vertical-align","top");$(".googleReportCellWB").css("vertical-align","top");console.log("END app.AlignTableCellContent")};n.GetPlayerName=function(i,r,u,f){return console.log("START app.GetPlayerName"),arguments.length===0&&(t=n.GetResultLocalStorage(),i=t.FirstName,r=t.NickName,u=t.LastName,f=t.Email),u==undefined&&(u=""),f==undefined&&(f=""),i!=""&&u!=""?i+"-"+u:i==""&&r!=""&&u!=""?r+"-"+u:i!=""&&u==""&&r!=""?i+"-"+r:i!=""&&u==""&&r==""?i:i==""&&u!=""&&r==""?u:i==""&&u==""&&r!=""?r:i==""&&u==""&&r==""&&f!=""?f:rt};n.NbrQuestionsAnswered=function(){for(console.log("START app.NbrQuestionsAnswered"),questionsAnswered=0,t=n.GetResultLocalStorage(),i=0;i<GameData.GameQuestions.length;i++)t.GameQuestions[i].SelChoiceId!=v&&questionsAnswered++;return console.log("END app.NbrQuestionsAnswered"),questionsAnswered};n.PopActiveGameFromQueueIntoCurrent=function(){console.log("START app.PopActiveGameFromQueueIntoCurrent");n.GetActiveGameIndexInQueue()!=-1&&n.PopQueueGames();console.log("END app.PopActiveGameFromQueueIntoCurrent")};n.PushQueueGames=function(i){if(console.log("START app.PushQueueGames"),GameData=n.GetGameLocalStorage(),t=n.GetResultLocalStorage(),gameConfig=n.GetGameConfigLocalStorage(),GameQueue=n.GetGameQueueLocalStorage(),GameListQueue=n.GetGameListQueueLocalStorage(),!n.IsPlayerGameSubmitted(t.PlayerId)){queueNbrStart=Math.min(GameQueue.length-1,tr-2);for(var r=queueNbrStart;r>=0;r--)GameListQueue[r+1]={},GameQueue[r+1]={},GameListQueue[r+1]=GameListQueue[r],GameQueue[r+1]=GameQueue[r];GameListQueue[0]={};GameQueue[0]={};GameListQueue[0].GameId=t.GameId;GameListQueue[0].GameCode=t.GameCode;GameListQueue[0].Name=GameData.Name;GameListQueue[0].FirstName=t.FirstName;GameListQueue[0].NickName=t.NickName;GameListQueue[0].LastName=t.LastName;GameListQueue[0].Email=t.Email;GameListQueue[0].GameState=i;GameListQueue[0].GameType=t.GameType;GameListQueue[0].PlayerId=t.PlayerId;GameQueue[0].Game=GameData;GameQueue[0].Result=t;GameQueue[0].GameConfig=gameConfig;n.PutGameListQueueLocalStorage(GameListQueue);n.PutGameQueueLocalStorage(GameQueue)}console.log("END app.PushQueueGames")};n.PopQueueGames=function(){console.log("START app.PopQueueGames");GameQueue=n.GetGameQueueLocalStorage();GameListQueue=n.GetGameListQueueLocalStorage();n.PutGameLocalStorage(GameQueue[0].Game);n.PutResultLocalStorage(GameQueue[0].Result);n.PutGameConfigLocalStorage(GameQueue[0].GameConfig);t=n.GetResultLocalStorage();(new n.Game).SetGameState(t.GameState);queueNbrStart=0;for(var i=queueNbrStart;i<GameQueue.length-1;i++)GameListQueue[i]=GameListQueue[i+1],GameQueue[i]=GameQueue[i+1];GameQueue.splice(GameQueue.length-1,1);GameListQueue.splice(GameQueue.length-1,1);n.PutGameListQueueLocalStorage(GameListQueue);n.PutGameQueueLocalStorage(GameQueue);console.log("END app.PopQueueGames")};n.IsGamesInQueue=function(t){for(console.log("START app.IsGamesInQueue"),returnStatus=!1,GameListQueue=n.GetGameListQueueLocalStorage(),i=0;i<=GameListQueue.length-1;i++)if(GameListQueue[i].GameState==t&&(returnStatus=!0),returnStatus)break;return console.log("END app.IsGamesInQueue"),returnStatus};n.GetNbrGamesInQueue=function(t){for(console.log("START app.GetNbrGamesInQueue"),getAllGamesInd=!1,t==undefined&&(getAllGamesInd=!0),count=0,GameListQueue=n.GetGameListQueueLocalStorage(),i=0;i<=GameListQueue.length-1;i++)(GameListQueue[i].GameState==t||getAllGamesInd)&&count++;return console.log("END app.GetNbrGamesInQueue"),count};n.GetActiveGameIndexInQueue=function(){for(console.log("START app.GetActiveGameIndexInQueue"),index=-1,GameListQueue=n.GetGameListQueueLocalStorage(),i=0;i<=GameListQueue.length-1;i++)if((GameListQueue[i].GameState==r.Active||GameListQueue[i].GameState==r.SubmittedActive)&&(index=i),index!=-1)break;return console.log("END app.GetActiveGameIndexInQueue"),index};n.IsGameSubmitted=function(t){for(console.log("START app.IsGameSubmitted"),isSubmitted=!1,GameListQueue=n.GetGameListQueueLocalStorage(),i=0;i<GameListQueue.length;i++)if(GameListQueue[i].GameId==t&&(isSubmitted=!0),isSubmitted)break;return console.log("END app.IsGameSubmitted"),isSubmitted};n.IsPlayerGameSubmitted=function(t){for(console.log("START app.IsPlayerGameSubmitted"),isSubmitted=!1,GameListQueue=n.GetGameListQueueLocalStorage(),i=0;i<GameListQueue.length;i++)if(GameListQueue[i].PlayerId==t&&(isSubmitted=!0),isSubmitted)break;return console.log("END app.IsPlayerGameSubmitted"),isSubmitted};n.GetAJAXFailureErrMessage=function(n,t,i){return console.log("START app.GetAJAXFailureErrMessage"),errorDetailDescLine="",(t!="error"||i!="")&&(errorDetailDescLine="<br/>("+t+", "+i+")"),console.log("END app.GetAJAXFailureErrMessage"),"There were connectivity issues for <i>"+n+"<\/i>."+errorDetailDescLine};n.GetGoogleChartFailureErrMessage=function(n,t){return console.log("START app.GetGoogleChartFailureErrMessage"),errorDetailDescLine="",t!=""&&(errorDetailDescLine="<br/>("+t+")"),console.log("END app.GetGoogleChartFailureErrMessage"),"There were connectivity issues for <i>"+n+"<\/i>."+errorDetailDescLine};n.popUpHelper=function(t,i,r){console.log("START app.popUpHelper");console.log("START app.popUpHelper");popupArgs=new PopupArgs;popupArgs.header=t;popupArgs.msg1=i;popupArgs.msg2=r;n.popUp(popupArgs);console.log("END app.popUpHelper")};n.popUp=function(n){console.log("START app.popUp");contentHtml="<table><tr><td>"+n.msg1+"<\/td><\/tr><tr><td>"+(n.msg2!=null?n.msg2:"")+"<\/tr><\/td><\/table>";$("#popMsgHeader").html(n.header);$("#popupMsgContent").html(contentHtml);$("#popupMsgYesBtn").show();$("#popupMsgYesBtn").attr("data-rel","back");$("#popupMsg").enhanceWithin().popup().popup("open",{transition:"fade"});console.log("END app.popUp")};n.SetQuestionChoicesSensitivity=function(n){console.log("START app.SetQuestionChoicesSensitivity");n?$("input[name ='choice']").checkboxradio().checkboxradio("enable").trigger("create"):($("input[name ='choice']").checkboxradio().checkboxradio("disable").trigger("create"),$('[for^="choice-"]').css("color","black"));console.log("END app.SetQuestionChoicesSensitivity")};n.confirmDialog=function(n,t,i){var u,r;console.log("START app.confirmDialog");u="popupDialog";$('<div data-role="popup" id="'+u+'" data-confirmed="no" data-transition="fade" data-overlay-theme="a" data-theme="a" data-dismissible="false" style="max-width:500px;">                     <div data-role="header" data-theme="a">                        <h1>'+n+'<\/h1>                    <\/div>                    <div role="main" class="ui-content popupContentFontSize" data-theme="a">                        <h3 class="ui-title">'+t+'<\/h3>                        <div style="text-align:right">                        <a href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-a optionConfirm popupButtonFontSize" data-rel="back" data-theme="a">Yes<\/a>                        <a "href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-a optionCancel popupButtonFontSize" data-rel="back" data-transition="flow" data-theme="a">No<\/a>                        <div>                    <\/div>                <\/div>').appendTo($.mobile.pageContainer);r=$("#"+u);r.trigger("create");r.popup({theme:"a"}).popup({afterclose:function(n){r.find(".optionConfirm").first().off("click");var t=r.attr("data-confirmed")==="yes"?!0:!1;$(n.target).remove();t&&i&&i()}});r.popup("open");r.find(".optionConfirm").first().on("click",function(){r.attr("data-confirmed","yes")});console.log("END app.confirmDialog")};n.GetConfigValue=function(t,r){for(console.log("START app.GetConfigValue"),config=t==f.Game?n.GetGameConfigLocalStorage():n.GetInCommonConfigLocalStorage(),parmValue="EmptyValue",i=0;i<config.length;i++)if(config[i].Name==r&&(parmValue=config[i].Value),parmValue!="EmptyValue")break;return console.log("END app.GetConfigValue"),parmValue};n.CreatePlayer=function(){return console.log("START app.CreatePlayer"),GameData=n.GetGameLocalStorage(),t=n.GetResultLocalStorage(),t.GameId=JSONdata.Id,t.FirstName=h,t.LastName=h,t.NickName=h,t.Email=h,t.Sex=p.Female,player={},player.FirstName=t.FirstName,player.LastName=t.LastName,player.NickName=t.NickName,player.Email=t.Email,player.Sex=t.Sex,console.log("END app.CreatePlayer"),player};n.DateLocalToUTC=function(n){return new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds()))};n.JQMWidgetsAllStyle=function(t){console.log("START app.JQMWidgetsAllStyle");new n.JQMWidget("firstName").JQMSetCSS("color",t);new n.JQMWidget("nickName").JQMSetCSS("color",t);new n.JQMWidget("lastName").JQMSetCSS("color",t);new n.JQMWidget("email").JQMSetCSS("color",t);widgetNameForFocus="";widgetNameForFocus=$.parseJSON(n.GetConfigValue(f.Game,"PlayerFirstNamePrompted"))?"firstName":$.parseJSON(n.GetConfigValue(f.Game,"PlayerNickNamePrompted"))?"nickName":$.parseJSON(n.GetConfigValue(f.Game,"PlayerLastNamePrompted"))?"lastName":"email";$("#"+widgetNameForFocus).focus();console.log("END app.JQMWidgetsAllStyle")};n.JQMWidgetsAllDisable=function(){console.log("START app.JQMWidgetsAllDisable");new n.JQMWidget("firstName").JQMSetAttr("disabled","disabled");new n.JQMWidget("nickName").JQMSetAttr("disabled","disabled");new n.JQMWidget("lastName").JQMSetAttr("disabled","disabled");new n.JQMWidget("email").JQMSetAttr("disabled","disabled");new n.JQMWidget("sex").JQMSetAttr("disabled","disabled");console.log("END app.JQMWidgetsAllDisable")};n.JQMWidgetsAllValidate=function(){if(console.log("START app.JQMWidgetsAllValidate"),minNameLength=parseInt(n.GetConfigValue(f.Game,"MinNameLengthPrompted")),maxNameLength=parseInt(n.GetConfigValue(f.Game,"MaxNameLengthPrompted")),$.parseJSON(n.GetConfigValue(f.Game,"PlayerFirstNamePrompted"))&&($("#firstName").val().length<minNameLength||$("#firstName").val().length>maxNameLength||$("#firstName").val().indexOf(" ")!=-1))throw Error("The first name must be between "+minNameLength+" and "+maxNameLength+" characters and contain no spaces.");if($.parseJSON(n.GetConfigValue(f.Game,"PlayerNickNamePrompted"))&&($("#nickName").val().length<minNameLength||$("#nickName").val().length>maxNameLength||$("#nickName").val().indexOf(" ")!=-1))throw Error("The nickname must be between "+minNameLength+" and "+maxNameLength+" characters and contain no spaces.");if($.parseJSON(n.GetConfigValue(f.Game,"PlayerLastNamePrompted"))&&($("#lastName").val().length<minNameLength||$("#lastName").val().length>maxNameLength||$("#lastName").val().indexOf(" ")!=-1))throw Error("The last Name must be between "+minNameLength+" and "+maxNameLength+" characters and contain no spaces.");return console.log("END app.JQMWidgetsAllValidate"),!0};n.JQMRender=function(){if(console.log("START app.JQMRender"),returnJQM="",this.Enabled)switch(this.Widget){case"firstName":returnJQM='<label for="firstName">First Name<\/label><input name="firstName" id="firstName" type="text" value="" data-clear-btn="true">';break;case"nickName":returnJQM='<label for="nickName">Nickname<\/label><input name="nickName" id="nickName" type="text" value="" data-clear-btn="true">';break;case"lastName":returnJQM='<label for="lastName">Last Name<\/label><input name="lastName" id="lastName" type="text" value="" data-clear-btn="true">';break;case"email":returnJQM='<label for="email">Email<\/label><input name="email" id="email" type="text" value="" data-clear-btn="true">';break;case"sex":returnJQM='<fieldset data-role="controlgroup" data-type="horizontal"><legend>Sex<\/legend><input name="sex" id="sex-male" type="radio" checked="checked" value="on"><label for="sex-male" style="font-size:0.8em;color: black;font-weight:bold;text-shadow: 0 0 0;text-align:center">Male<\/label><input name="sex" id="sex-female" type="radio"><label for="sex-female" style="font-size:0.8em;color: black;font-weight:bold;text-shadow: 0 0 0">Female<\/label><\/fieldset>'}return console.log("END app.JQMRender"),returnJQM};n.JQMSetValue=function(){console.log("START app.JQMSetValue");this.Enabled&&(this.Widget!="sex"?$("input[name='"+this.Widget+"']").attr("value",this.Value):this.Value==p.Male?($("#sex-male").attr("checked",!0),$("#sex-female").attr("checked",!1)):($("#sex-male").attr("checked",!1),$("#sex-female").attr("checked",!0)));console.log("END app.JQMSetValue")};n.JQMGetValue=function(){return console.log("START app.JQMGetValue"),this.Value=h,this.Enabled&&(this.Value=this.Widget!="sex"?$("#"+this.Widget).val():$("#sex-male").attr("checked")=="checked"?p.Male:p.Female),console.log("END app.JQMGetValue"),this.Value};n.JQMSetCSS=function(n){console.log("START app.JQMSetCSS");this.Enabled&&$("#"+this.Widget).css(n,"black");console.log("END app.JQMSetCSS")};n.JQMSetAttr=function(n,t){console.log("START app.JQMSetAttr");this.Enabled&&$("#"+this.Widget).attr(n,t);console.log("END app.JQMSetAttr")};n.JQMWidget=function(t){console.log("START app.JQMWidget");_result=n.GetResultLocalStorage();this.Widget=t;this.Enabled=!1;this.Value="";switch(this.Widget){case"firstName":$.parseJSON(n.GetConfigValue(f.Game,"PlayerFirstNamePrompted"))&&(this.Enabled=!0,this.Value=_result.FirstName);break;case"nickName":$.parseJSON(n.GetConfigValue(f.Game,"PlayerNickNamePrompted"))&&(this.Enabled=!0,this.Value=_result.NickName);break;case"lastName":$.parseJSON(n.GetConfigValue(f.Game,"PlayerLastNamePrompted"))&&(this.Enabled=!0,this.Value=_result.LastName);break;case"email":$.parseJSON(n.GetConfigValue(f.Game,"PlayerEmailPrompted"))&&(this.Enabled=!0,this.Value=_result.Email);break;case"sex":$.parseJSON(n.GetConfigValue(f.Game,"PlayerSexPrompted"))&&(this.Enabled=!0,this.Value=_result.Sex)}this.JQMRender=n.JQMRender;this.JQMSetValue=n.JQMSetValue;this.JQMGetValue=n.JQMGetValue;this.JQMSetAttr=n.JQMSetAttr;console.log("END app.JQMWidget")};n.PlayerCreate=function(){return console.log("START app.PlayerCreate"),this._Player.GameId=this._result.GameId,this._Player.GameCode=this._result.GameCode,this._result.PlayerId==h?(this._Player.Id=0,this._result.FirstName!=h&&(this._Player.FirstName=this._result.FirstName),this._result.NickName!=h&&(this._Player.NickName=this._result.NickName),this._result.LastName!=h&&(this._Player.LastName=this._result.LastName),this._result.Email!=h&&(this._Player.Email=this._result.Email),this._Player.Sex=t.Sex):this._Player.Id=this._result.PlayerId,this._Player.ClientVersion=k,console.log("END app.PlayerCreate"),this._Player};n.Player=function(){console.log("START app.Player");this._result=n.GetResultLocalStorage();this._Player={};this.PlayerCreate=n.PlayerCreate;console.log("END app.Player")};n.GameAnswersCreate=function(n){if(console.log("START app.GameAnswersCreate"),this._result.GameType!=u.LMS)for(i=0;i<this._GameData.GameQuestions.length;i++)this._GameAnswers[i]={},this._GameAnswers[i].PlayerId=n.Id,this._GameAnswers[i].GameCode=this._result.GameCode,this._GameAnswers[i].QuestionNbr=i+1,this._GameAnswers[i].QuestionId=this._result.GameQuestions[i].QuestionId,this._GameAnswers[i].ChoiceId=this._result.GameQuestions[i].SelChoiceId;else this._GameAnswers[0]={},this._GameAnswers[0].PlayerId=n.Id,this._GameAnswers[0].GameCode=this._result.GameCode,this._GameAnswers[0].QuestionNbr=e+1,this._GameAnswers[0].QuestionId=this._result.GameQuestions[e].QuestionId,this._GameAnswers[0].ChoiceId=this._result.GameQuestions[e].SelChoiceId;return console.log("END app.GameAnswersCreate"),this._GameAnswers};n.GameAnswers=function(){console.log("START app.GameAnswers");this._result=n.GetResultLocalStorage();this._GameData=n.GetGameLocalStorage();this._GameAnswers=[];this.GameAnswersCreate=n.GameAnswersCreate;console.log("END app.GameAnswers")};n.ProcessMessageForGAResponse=function(t){console.log("START app.ProcessMessageForGAResponse");this.GameRefresh();this._result.GameType==u.LMS?(popupMessage=this._result.QuestionNbrSubmitted!=c?this._result.GameQuestions[this._result.QuestionNbrSubmitted].Correct&&this._result.ServerResponse==a?this.ProcessMessage(ht):this._result.GameQuestions[this._result.QuestionNbrSubmitted].Correct||this._result.ServerResponse!=a?t:this.ProcessMessage(ti):t,popupMessage!=null&&n.popUpHelper("Info",popupMessage,null)):(popupMessage=this.ProcessMessage(ht),t==null?n.popUpHelper("Info",popupMessage,null):n.popUpHelper("Error",'The submission of the Game<br/><span class="popupGameName">'+GameData.Name+"<\/span><br/> was NOT successful.<p>"+t+"<\/p>",null));console.log("END app.ProcessMessageForGAResponse")};n.ProcessMessage=function(t){return console.log("START app.ProcessMessage"),this.GameRefresh(),originalMsg=n.GetConfigValue(f.Game,t),returnMsg=originalMsg.replace("Game.Name",this._GameData.Name),returnMsg=returnMsg.replace("Player.Name",n.GetPlayerName(this._result.FirstName,this._result.NickName,this._result.LastName,this._result.Email)),this._result.GameType==u.LMS&&this._result.QuestionNbrSubmitted!=c&&(dateCurrentQuestionStartLocal=this.GetQuesStartDate(this._result.QuestionNbrSubmitted),dateNextQuestionStartLocal=this.GetQuesStartDate(this._result.QuestionNbrSubmitted+1),dateCurrentQuestionDeadlineLocal=this.GetQuesDeadlineDate(this._result.QuestionNbrSubmitted),dateNextQuestionDeadlineLocal=this.GetQuesDeadlineDate(this._result.QuestionNbrSubmitted+1),returnMsg=returnMsg.replace("Stats.NbrQuestionsSubmitted",this._result.QuestionNbrSubmitted+1),returnMsg=returnMsg.replace("Stats.NbrPlayers",this._result.NbrPlayers),returnMsg=returnMsg.replace("Stats.NbrPlayersRemaining",this._result.NbrPlayersRemaining),returnMsg=returnMsg.replace("Deadline.CurrentQuestion",GetInCommonLocaleDTString(dateCurrentQuestionDeadlineLocal)),returnMsg=this._result.QuestionNbrSubmitted<this._result.GameQuestions.length-1?returnMsg.replace("Start.NextQuestion",GetInCommonLocaleDTString(dateNextQuestionStartLocal)):returnMsg.replace("Start.NextQuestion","NO MORE QUESTIONS AND STILL STANDING"),returnMsg=this._result.QuestionNbrSubmitted<this._result.GameQuestions.length-1?returnMsg.replace("Deadline.NextQuestion",GetInCommonLocaleDTString(dateNextQuestionDeadlineLocal)):returnMsg.replace("Deadline.NextQuestion","NO MORE QUESTIONS AND STILL STANDING")),console.log("END app.ProcessMessage"),returnMsg};n.GetQuesWarningDate=function(n){return console.log("START app.GetQuesWarningDate"),this.GameRefresh(),n>=this._result.GameQuestions.length&&(n=this._result.GameQuestions.length-1),console.log("END app.GetQuesWarningDate"),new Date(this._result.GameQuestions[n].QuestionWarningDT)};n.GetQuesStartDate=function(n){return console.log("START app.GetQuesStartDate"),this.GameRefresh(),n>=this._result.GameQuestions.length&&(n=this._result.GameQuestions.length-1),console.log("END app.GetQuesStartDate"),new Date(this._result.GameQuestions[n].QuestionStartDT)};n.GetQuesDeadlineDate=function(n){return console.log("START app.GetQuesDeadlineDate"),this.GameRefresh(),n>=this._result.GameQuestions.length&&(n=this._result.GameQuestions.length-1),console.log("END app.GetQuesDeadlineDate"),new Date(this._result.GameQuestions[n].QuestionDeadlineDT)};n.SetQuesCorrectionStyle=function(n){console.log("START app.SetQuesCorrectionStyle");this.GameRefresh();$("#questionText").css("padding-top","6px");this._result.GameType==u.LMS?($("#questionText").css("padding-top","10px"),selChoiceId=this._result.GameQuestions[n].SelChoiceId,$("#playerConsoleText").html(""),$("#playerConsoleText").css("font-weight","bold"),$("#playerConsoleText").css("text-align","center"),selChoiceId!=v&&n<=this._result.QuestionNbrSubmitted&&!(this._result.GameQuestions[n].Reason==y)?this._result.GameQuestions[n].Correct?($('[for="choice-'+selChoiceId+'"]').css("background",ot),$("#playerConsoleText").html("**Correct Answer**"),$("#playerConsoleText").css("color",ot)):($('[for="choice-'+selChoiceId+'"]').css("background",g),$("#playerConsoleText").html("**Incorrect Answer**"),$("#playerConsoleText").css("color",g)):this._result.PlayerActive||this._result.GameQuestions[n].Reason!=y?$("#playerConsoleText").html(""):($("#playerConsoleText").html("**Answer never submitted**"),$("#playerConsoleText").css("color",g))):$("#playerConsoleText").html("");console.log("END app.SetQuesCorrectionStyle")};n.IsNewQuestionDeadlineNotPassed=function(){return console.log("START app.IsNewQuestionDeadlineNotPassed"),this.GameRefresh(),this._result.GameType==u.LMS?(dateCurrentQuestionDeadlineLocal=this.GetQuesDeadlineDate(this._result.QuestionNbrSubmitted+1),dateCurrentLocal=new Date,console.log("deadline: "+dateCurrentQuestionDeadlineLocal.getTime()+" current:"+dateCurrentLocal.getTime()),dateCurrentLocal<=dateCurrentQuestionDeadlineLocal):!0};n.SetQuesCountdown=function(t,i){console.log("START app.SetQuesCountdown - questionNbr:"+t);this.GameRefresh();CountdownIntervalInSecs=parseInt(n.GetConfigValue(f.Game,"CountdownIntervalInSecs"));$("#questionText").css("padding-top","6px");this._result.GameType==u.LMS&&($("#questionText").css("padding-top","10px"),countDownClockHtml='<ul id="qCountdown" class="countdownStyle"><\/ul>',dateCurrentQuestionStartLocal=this.GetQuesStartDate(t),dateNextQuestionStartLocal=this.GetQuesStartDate(this._result.QuestionNbrSubmitted+1),dateCurrentQuestionDeadlineLocal=this.GetQuesDeadlineDate(t),dateNextQuestionDeadlineLocal=this.GetQuesDeadlineDate(this._result.QuestionNbrSubmitted+1),dateCurrentQuestionWarningLocal=this.GetQuesWarningDate(t),dateNextQuestionWarningLocal=this.GetQuesWarningDate(this._result.QuestionNbrSubmitted+1),dateCurrentLocal=new Date,(this._result.QuestionNbrSubmitted==c&&t==0||t==this._result.QuestionNbrSubmitted+1)&&this._result.PlayerActive&&dateCurrentLocal>=dateCurrentQuestionStartLocal?(this.SetClockCountdownEnable("qstart",!1),$("#playerConsoleText").html(countDownClockHtml),(!this.IsClockCountdownEnable("qdeadline")||i)&&(b=!1,i||this._result.QuestionNbrSubmitted!=c||t!=0||(new n.Game).SetLocalNotifications(dateCurrentLocal,dateCurrentQuestionWarningLocal,dateCurrentQuestionDeadlineLocal),questionDeadlineDTUTC=n.DateLocalToUTC(dateCurrentQuestionDeadlineLocal),$("#qCountdown").countdown({id:"qdeadline",divAnchor:"playerConsoleText",date:questionDeadlineDTUTC,dateBufferSecs:st,bufferTimeSecs:d,clockInd:!0,OneTimeInd:i,interval:CountdownIntervalInSecs,color:"#00edf0",warningSecs:60,warningColor:"#00edf0",dateViewSecs:10,auxId1:"listviewCountdown",auxId2:"popupCountdown"},function(){b?console.log("QUESTION HANDLER DID NOT RUN - SUBMIT IN PROGRESS - SUBMIT IN PROGRESS"):(console.log("Question Deadline Countdown function start"),n.PopActiveGameFromQueueIntoCurrent(),gameObj=new n.Game,gameObj._result.PlayerActive=!1,gameObj._result.QuestionNbrSubmitted++,gameObj._result.GameQuestions[gameObj._result.QuestionNbrSubmitted].Correct=!1,gameObj._result.GameQuestions[gameObj._result.QuestionNbrSubmitted].Reason=y,n.PutResultLocalStorage(gameObj._result),gameObj.SetGameStatePostSubmit(),gameObj.SetGamePostSubmit(r.ReadOnly),gameObj.NavigateAfterGAResponse(),n.popUpHelper("Info","I'm sorry, you have run out of time. The deadline for answering and submitting the question has passed. You'll have to sit out the rest of the game.",null))}))):(this._result.QuestionNbrSubmitted==c&&t==0||t<=this._result.QuestionNbrSubmitted)&&this._result.PlayerActive&&dateCurrentLocal<dateNextQuestionStartLocal&&(this.SetClockCountdownEnable("qdeadline",!1),$("#playerConsoleText").html(countDownClockHtml),(!this.IsClockCountdownEnable("qstart")||i)&&(i||(new n.Game).SetLocalNotifications(dateCurrentLocal,dateNextQuestionWarningLocal,dateNextQuestionDeadlineLocal),questionStartDTUTC=n.DateLocalToUTC(dateQuestionStartLocal),$("#qCountdown").countdown({id:"qstart",divAnchor:"playerConsoleText",date:questionStartDTUTC,dateBufferSecs:st,bufferTimeSecs:d,clockInd:!0,OneTimeInd:i,interval:CountdownIntervalInSecs,color:"#00edf0",warningSecs:60,warningColor:"#00edf0",dateViewSecs:10,auxId1:"listviewCountdown",auxId2:"popupCountdown"},function(){console.log("Question Start Countdown function start");n.PopActiveGameFromQueueIntoCurrent();n.StartGame(!0);n.popUpHelper("Info","The next question in your game has been queued up for you. Go for it!",null)}))));console.log("END app.SetQuesCountdown")};n.RunQuesCountdownOnce=function(n){console.log("START app.RunClockCountdownOnce");this.GameRefresh();this._result.GameType==u.LMS&&(questionNbrToUse=0,n!=undefined?questionNbrToUse=n:this._result.QuestionNbrSubmitted!=c&&(questionNbrToUse=this.IsClockCountdownEnable("qstart")?this._result.QuestionNbrSubmitted:this._result.QuestionNbrSubmitted+1),this.SetQuesCountdown(questionNbrToUse,!0));console.log("END app.RunClockCountdownOnce")};n.GetListviewClockCountdownHtml=function(){return console.log("START app.GetListviewClockCountdownHtml"),this.GameRefresh(),ccHtml="",this._result.GameType==u.LMS&&(this.IsClockCountdownEnable("qstart")||this.IsClockCountdownEnable("qdeadline"))&&(countDownClockHtml='<ul id="listviewCountdown" class="countdownStyle"><\/ul>',ccHtml=countDownClockHtml),console.log("END app.GetListviewClockCountdownHtml"),ccHtml};n.GetListViewReportBtnHtml=function(){return console.log("START app.GetListViewReportBtnHtml"),this.GameRefresh(),btnHtml="",this._result.GameType==u.LMS&&this._result.GameState==r.SubmittedActive&&(btnHtml='<a href="#" class="gameReportAction" data-index="-1"><\/a>'),console.log("END app.GetListViewReportBtnHtml"),btnHtml};n.GetListViewReportIconHtml=function(){return console.log("START app.GetListViewReportIconHtml"),this.GameRefresh(),iconHtml="star",this._result.GameType==u.LMS&&this._result.GameState==r.SubmittedActive&&(iconHtml="bar-chart-o"),console.log("END app.GetListViewReportIconHtml"),iconHtml};n.SetClockCountdownEnable=function(n,t){console.log("START app.SetClockCountdownEnable");this.GameRefresh();this._result.GameType==u.LMS&&(t?$("#playerConsoleText").attr("countdown-enabled-"+n,"true"):$("#playerConsoleText").attr("countdown-enabled-"+n,"false"));console.log("END app.SetClockCountdownEnable")};n.StartupClockCountdown=function(){console.log("START app.StartupClockCountdown");this.GameRefresh();this._result.GameType==u.LMS&&(this._result.GameState==r.Active||this._result.GameState==r.SubmittedActive)&&(questionNbr=this.StartQuestionNbr(),this.SetQuesCountdown(questionNbr,!1));console.log("END app.StartupClockCountdown")};n.StopClockCountdown=function(){console.log("START app.StartupClockCountdown");this.GameRefresh();this._result.GameType==u.LMS&&this._result.PlayerActive==!0&&(this.SetClockCountdownEnable("qstart",!1),this.SetClockCountdownEnable("qdeadline",!1));console.log("END app.StartupClockCountdown")};n.IsClockCountdownEnable=function(n){return console.log("START app.SetClockCountdownEnable"),this.GameRefresh(),clockCountdownEnable=!1,this._result.GameType==u.LMS&&($("#playerConsoleText").attr("countdown-enabled-"+n)==undefined?clockCountdownEnable=!1:$("#playerConsoleText").attr("countdown-enabled-"+n)=="true"&&(clockCountdownEnable=!0)),console.log("END app.SetClockCountdownEnable"),clockCountdownEnable};n.SetQuesInfo=function(t){console.log("START app.SetQuesInfo");this.GameRefresh();this._result.GameType==u.LMS?$("#choiceListLegend").html('<span class="bodyText">Question #'+(t+1)+($.parseJSON(n.GetConfigValue(f.Game,"ViewNbrOfQuestionsTotal"))?" of "+this.NbrQuestions():"")+"<\/span>"):$("#choiceListLegend").html('<span class="bodyText">Question #'+(t+1)+" of "+this.NbrQuestions()+"<\/span>");console.log("END app.SetQuesInfo")};n.SetQuesChoiceSensitivity=function(){console.log("START app.SetQuesChoiceSensitivity");this.GameRefresh();o==r.ReadOnly||o==r.SubmittedActive&&this._result.GameType==u.LMS&&this._result.QuestionNbrSubmitted>=e?n.SetQuestionChoicesSensitivity(!1):n.SetQuestionChoicesSensitivity(!0);console.log("END app.SetQuesChoiceSensitivity")};n.SetQuesNavigate=function(){console.log("START app.SetQuesNavigate");this.GameRefresh();$("#question article .backButton").css("visibility","visible");$("#question article .nextButton").css("visibility","visible");this._result.GameType==u.LMS&&(this._result.QuestionNbrSubmitted!=c&&(this._result.QuestionNbrSubmitted!=0||this._result.PlayerActive)||($("#question article .backButton").css("visibility","hidden"),$("#question article .nextButton").css("visibility","hidden")));console.log("END app.SetQuesNavigate")};n.NavigateAfterGAResponse=function(){console.log("START app.NavigateAfterGAResponse");this.GameRefresh();this._result.GameType==u.LMS?this.StartGame(!0):(n.SetHomePageStyle(!1),n.SetHomePageInitialDisplay(),$(":mobile-pagecontainer").pagecontainer("change","#home",{transition:"none"}));console.log("END app.NavigateAfterGAResponse")};n.PostGAResponse=function(t){if(console.log("START app.PostGAResponse"),this.GameRefresh(),returnErrMsg=null,t.errorid==undefined){if(t.PlayerGameStatus!=undefined){switch(t.PlayerGameStatus.MessageId){case a:this._result.PlayerId=t.Id;this._result.QuestionNbrSubmitted=e;this._result.NbrPlayers=t.PlayerGameStatus.NbrPlayers;this._result.NbrPlayersRemaining=t.PlayerGameStatus.NbrPlayersRemaining;t.PlayerGameStatus.NbrAnswersCorrect>0?(this._result.PlayerActive=!0,this._result.GameQuestions[e].Correct=!0):(this._result.PlayerActive=!1,this._result.GameQuestions[e].Correct=!1,this._result.GameQuestions[e].Reason=et);this._result.ServerResponse=a;break;case ui:this._result.ServerResponse=t.PlayerGameStatus.MessageId;returnErrMsg=t.PlayerGameStatus.Message;break;case fi:this._result.ServerResponse=t.PlayerGameStatus.MessageId;playerName=n.GetPlayerName(this._result.FirstName,this._result.NickName,this._result.LastName,this._result.Email);returnErrMsg="Your player name ("+playerName+") is already in use. Please go to the HOME page and then select the active game (this game).<br/>Modify your player name and resubmit the game answer(s) to the In Common Cloud";break;case ei:this._result.ServerResponse=t.PlayerGameStatus.MessageId;returnErrMsg=t.PlayerGameStatus.Message;break;case oi:this._result.ServerResponse=t.PlayerGameStatus.MessageId;returnErrMsg=t.PlayerGameStatus.Message;break;case si:this._result.ServerResponse=t.PlayerGameStatus.MessageId;returnErrMsg=t.PlayerGameStatus.Message;break;case hi:this._result.ServerResponse=t.PlayerGameStatus.MessageId;break;case ci:this._result.ServerResponse=t.PlayerGameStatus.MessageId;returnErrMsg=t.PlayerGameStatus.Message;break;case li:this._result.ServerResponse=t.PlayerGameStatus.MessageId;returnErrMsg=t.PlayerGameStatus.Message;break;case ct:this._result.PlayerActive=!1;this._result.GameQuestions[e].Correct=!1;this._result.GameQuestions[e].Reason=y;this._result.ServerResponse=t.PlayerGameStatus.MessageId;returnErrMsg="The player submission was beyond the question deadline. Sorry, but you will have to sit out the rest of the game.";break;case ai:this._result.PlayerActive=!1;this._result.ServerResponse=t.PlayerGameStatus.MessageId;returnErrMsg=t.PlayerGameStatus.Message;break;case vi:returnErrMsg=t.PlayerGameStatus.Message;break;default:this._result.PlayerActive=!1;this._result.GameQuestions[e].Correct=!1;this._result.GameQuestions[e].Reason=ni;this._result.ServerResponse=t.PlayerGameStatus.MessageId;returnErrMsg=t.PlayerGameStatus.Message}this._result.GameType==u.LMS&&this._result.QuestionNbrSubmitted>=this._result.GameQuestions.length-1&&(this._result.PlayerActive=!1)}}else this._result.ServerResponse=t.errorid,returnErrMsg="There was an In Common server error. Please try submitting again. If the error persists, contact In Common support.";if(n.PutResultLocalStorage(this._result),returnErrMsg!=null)return returnErrMsg;console.log("END app.PostGAResponse")};n.IsGameSubmit=function(){return console.log("START app.IsGameSubmit"),this.GameRefresh(),gameToSubmitInd=!1,(this._result.ServerResponse==a||this._result.ServerResponse==ct)&&(gameToSubmitInd=!0),console.log("END app.IsGameSubmit"),gameToSubmitInd};n.AlertPlayerComplete=function(t,i){console.log("START app.AlertPlayerComplete");this.GameRefresh();this._result.GameType!=u.LMS&&o!=r.ReadOnly&&(t==i&&this.IsAllQuestionsAnswered()?n.confirmDialog("Submit",'You have answered all the questions for the Game <span class="popupGameName">'+this._GameData.Name+"<\/span>.<p>Do you want to submit?<\/p>",function(){$.mobile.loading("show");setTimeout(function(){n.ConfirmSubmit()},1e3*d)}):t!=i||this.IsAllQuestionsAnswered()||n.confirmDialog("Summary",'You have NOT answered all the questions of the Game <span class="popupGameName">'+this._GameData.Name+"<\/span>.<p>Do you want to see the Summary page to find which questions have NOT been answered?<\/p>",function(){n.SetSummaryPage()}));console.log("END app.AlertPlayerComplete")};n.IsAllQuestionsAnswered=function(){for(console.log("START app.IsAllQuestionsAnswered"),this.GameRefresh(),allAnswered=!0,i=0;i<this.NbrQuestions();i++)if(this._result.GameQuestions[i].SelChoiceId==v&&(allAnswered=!1),!allAnswered)break;return console.log("END app.IsAllQuestionsAnswered"),allAnswered};n.StartQuestionNbr=function(){return console.log("START app.StartQuestionNbr"),this.GameRefresh(),startQuestionNbr=0,this._result.GameType==u.LMS?(dateQuestionStartLocal=this.GetQuesStartDate(this._result.QuestionNbrSubmitted+1),dateCurrentLocal=new Date,startQuestionNbr=this._result.QuestionNbrSubmitted==c?0:this._result.QuestionNbrSubmitted!=c&&this._result.PlayerActive&&dateCurrentLocal<dateQuestionStartLocal?this._result.QuestionNbrSubmitted:this._result.QuestionNbrSubmitted!=c&&this._result.PlayerActive&&dateCurrentLocal>=dateQuestionStartLocal?this._result.QuestionNbrSubmitted+1:this._result.QuestionNbrSubmitted,Math.min(startQuestionNbr,this._result.GameQuestions.length-1)):startQuestionNbr};n.NbrQuestions=function(){return console.log("START app.NbrQuestions"),this.GameRefresh(),NbrQuestions=0,this._result.GameType==u.LMS?(dateQuestionStartLocal=this.GetQuesStartDate(this._result.QuestionNbrSubmitted+1),dateCurrentLocal=new Date,NbrQuestions=this._result.QuestionNbrSubmitted==c?1:this._result.QuestionNbrSubmitted!=c&&this._result.PlayerActive&&dateCurrentLocal<dateQuestionStartLocal?this._result.QuestionNbrSubmitted+1:this._result.QuestionNbrSubmitted!=c&&this._result.PlayerActive&&dateCurrentLocal>=dateQuestionStartLocal?this._result.QuestionNbrSubmitted+2:this._result.QuestionNbrSubmitted+1,Math.min(NbrQuestions,this._result.GameQuestions.length)):NbrQuestions=this._result.GameQuestions.length};n.BackButtonHandler=function(){console.log("START app.BackButtonHandler");this.GameRefresh();e==ft?e=this.NbrQuestions()-1:e--;n.SetQuestionPage(e,"none");console.log("END app.BackButtonHandler")};n.NextButtonHandler=function(){console.log("START app.NextButtonHandler");this.GameRefresh();e==this.NbrQuestions()-1?e=0:e++;n.SetQuestionPage(e,"none");this.AlertPlayerComplete(e,0);console.log("END app.NextButtonHandler")};n.SetBottomNavButtons=function(n,t,i,f){console.log("START app.SetBottomNavButtons");this.GameRefresh();this._result.GameType==u.LMS?n&&this._result.QuestionNbrSubmitted!=c&&(this._result.QuestionNbrSubmitted!=0||this._result.PlayerActive)?$(".backButton").hasClass("ui-disabled")&&$(".backButton").removeClass("ui-disabled"):$(".backButton").hasClass("ui-disabled")||$(".backButton").addClass("ui-disabled"):n?$(".backButton").hasClass("ui-disabled")&&$(".backButton").removeClass("ui-disabled"):$(".backButton").hasClass("ui-disabled")||$(".backButton").addClass("ui-disabled");t?$(".summaryButton").hasClass("ui-disabled")&&$(".summaryButton").removeClass("ui-disabled"):$(".summaryButton").hasClass("ui-disabled")||$(".summaryButton").addClass("ui-disabled");i&&this.IsAllQuestionsAnswered()&&o!=r.ReadOnly?$(".submitButton").hasClass("ui-disabled")&&$(".submitButton").removeClass("ui-disabled"):$(".submitButton").hasClass("ui-disabled")||$(".submitButton").addClass("ui-disabled");this._result.GameType==u.LMS?f&&this._result.QuestionNbrSubmitted!=c&&(this._result.QuestionNbrSubmitted!=0||this._result.PlayerActive)?$(".nextButton").hasClass("ui-disabled")&&$(".nextButton").removeClass("ui-disabled"):$(".nextButton").hasClass("ui-disabled")||$(".nextButton").addClass("ui-disabled"):f?$(".nextButton").hasClass("ui-disabled")&&$(".nextButton").removeClass("ui-disabled"):$(".nextButton").hasClass("ui-disabled")||$(".nextButton").addClass("ui-disabled");console.log("END app.SetBottomNavButtons")};n.StartGame=function(t){console.log("START app.StartGame");this.GameRefresh();questionNbr=t||o!=r.ReadOnly?this.StartQuestionNbr():0;o==r.Idle?this.SetGameState(r.Active):o==r.ReadOnly&&this.SetGameState(r.ReadOnly);e=questionNbr;n.SetQuestionPage(e,"none");console.log("END app.StartGame")};n.IsGameInProgress=function(){return console.log("START app.IsGameInProgress"),this.GameRefresh(),IsGameInProgress=!1,this._result!={}&&(this._result.GameState==r.Active||this._result.GameState==r.SubmittedActive)&&(IsGameInProgress=!0),console.log("END app.IsGameInProgress"),IsGameInProgress};n.SetGameState=function(t){console.log("START app.SetGameState");this.GameRefresh();o=t;this._result.GameState=o;n.PutResultLocalStorage(this._result);console.log("END app.SetGameState")};n.SetGamePostSubmit=function(t){console.log("START app.SetGamePostSubmit");this.GameRefresh();t==r.ReadOnly?(this.SetBottomNavButtons(!1,!1,!1,!1),$("[data-icon='plus']").removeClass("ui-disabled"),$("[data-icon='minus']").addClass("ui-disabled"),n.PushQueueGames(r.Submitted)):n.PushQueueGames(r.SubmittedActive);console.log("END app.SetGamePostSubmit")};n.SetGameStatePostSubmit=function(){console.log("START app.SetGameStatePostSubmit");this.GameRefresh();o=this._result.GameType!=u.LMS?r.ReadOnly:this._result.GameType==u.LMS&&this._result.PlayerActive?r.SubmittedActive:r.ReadOnly;this._result.GameState=o;n.PutResultLocalStorage(this._result);console.log("END app.SetGameStatePostSubmit")};n.PlayerPromptInteractive=function(){console.log("START app.PlayerPromptInteractive");this.GameRefresh();$("#reportGame").hide();o!=r.Idle&&(new n.JQMWidget("firstName").JQMSetValue(),new n.JQMWidget("nickName").JQMSetValue(),new n.JQMWidget("lastName").JQMSetValue(),new n.JQMWidget("email").JQMSetValue(),new n.JQMWidget("sex").JQMSetValue(),(o==r.ReadOnly||this._result.GameType==u.LMS&&o==r.SubmittedActive)&&n.JQMWidgetsAllDisable(),o==r.ReadOnly?(this._result.ClientReportAccess?$("#reportGame").removeClass("ui-disabled"):$("#reportGame").addClass("ui-disabled"),$("#reportGame").show(),$("#startGame").text("View Game")):this._result.GameType==u.LMS&&o==r.SubmittedActive?($("#startGame").text("Resume Game"),$("#reportGame").show()):$("#startGame").text("Resume Game"));$("#homePageContent").trigger("create");$(window).trigger("resize");o==r.ReadOnly&&$("#startGame,#cancelGame,#reportGame").addClass("GameReadOnlyButtons");this._result.GameType==u.LMS&&o==r.SubmittedActive?$("#cancelGame").hide():$("#cancelGame").show();console.log("END app.PlayerPromptInteractive")};n.SetLocalNotifications=function(t,i,r){console.log("START app.SetLocalNotifications");this.GameRefresh();var e=document.URL.indexOf("http://")===-1&&document.URL.indexOf("https://")===-1;if(this._result.GameType==u.LMS&&(QuestionTimeWarningInSecs=parseInt(n.GetConfigValue(f.Game,nt)),QuestionTimeWarningInSecs!=0&&e&&(isMobile.Android()!=null||isMobile.iOS()!=null)&&i>t&&i<r)){dateStr=GetInCommmonLocaleDateString(r)+" "+GetInCommmonLocaleTimeString(r);cordova.plugins.notification.local.schedule({id:isMobile.Android()!=null?"1":1,title:"Question deadline approaching",text:"Question Deadline: "+dateStr,at:i,sound:null,data:null});cordova.plugins.notification.local.on("click",function(t){console.log("notification clicked on: "+t.id);n.PopActiveGameFromQueueIntoCurrent();n.StartGame(!0)});console.log("scheduled local notification at "+GetInCommmonLocaleDateString(i)+" "+GetInCommmonLocaleTimeString(i))}console.log("END app.SetLocalNotifications")};n.ResetLocalNotifications=function(){console.log("START app.ResetLocalNotifications");this.GameRefresh();var t=document.URL.indexOf("http://")===-1&&document.URL.indexOf("https://")===-1;this._result.GameType==u.LMS&&(QuestionTimeWarningInSecs=parseInt(n.GetConfigValue(f.Game,nt)),QuestionTimeWarningInSecs!=0&&t&&(isMobile.Android()!=null||isMobile.iOS()!=null)&&cordova.plugins.notification.local.cancelAll(function(){console.log("cancel all local notifications")},this));console.log("END app.ResetLocalNotifications")};n.GameRefresh=function(){console.log("START app.GameRefresh");this._result=n.GetResultLocalStorage();this._GameData=n.GetGameLocalStorage();this._app=n;console.log("END app.GameRefresh")};n.Game=function(){console.log("START app.Game");this._result=n.GetResultLocalStorage();this._GameData=n.GetGameLocalStorage();this._app=n;this.PlayerPromptInteractive=n.PlayerPromptInteractive;this.StartGame=n.StartGame;this.SetGamePostSubmit=n.SetGamePostSubmit;this.SetGameStatePostSubmit=n.SetGameStatePostSubmit;this.SetGameState=n.SetGameState;this.IsGameInProgress=n.IsGameInProgress;this.GetQuesWarningDate=n.GetQuesWarningDate;this.GetQuesStartDate=n.GetQuesStartDate;this.GetQuesDeadlineDate=n.GetQuesDeadlineDate;this.SetQuesChoiceSensitivity=n.SetQuesChoiceSensitivity;this.SetQuesInfo=n.SetQuesInfo;this.SetQuesCorrectionStyle=n.SetQuesCorrectionStyle;this.IsNewQuestionDeadlineNotPassed=n.IsNewQuestionDeadlineNotPassed;this.StartupClockCountdown=n.StartupClockCountdown;this.StopClockCountdown=n.StopClockCountdown;this.SetQuesCountdown=n.SetQuesCountdown;this.RunQuesCountdownOnce=n.RunQuesCountdownOnce;this.GetListviewClockCountdownHtml=n.GetListviewClockCountdownHtml;this.GetListViewReportBtnHtml=n.GetListViewReportBtnHtml;this.GetListViewReportIconHtml=n.GetListViewReportIconHtml;this.SetClockCountdownEnable=n.SetClockCountdownEnable;this.IsClockCountdownEnable=n.IsClockCountdownEnable;this.SetQuesNavigate=n.SetQuesNavigate;this.BackButtonHandler=n.BackButtonHandler;this.NextButtonHandler=n.NextButtonHandler;this.SetBottomNavButtons=n.SetBottomNavButtons;this.NbrQuestions=n.NbrQuestions;this.IsAllQuestionsAnswered=n.IsAllQuestionsAnswered;this.AlertPlayerComplete=n.AlertPlayerComplete;this.StartQuestionNbr=n.StartQuestionNbr;this.PostGAResponse=n.PostGAResponse;this.IsGameSubmit=n.IsGameSubmit;this.NavigateAfterGAResponse=n.NavigateAfterGAResponse;this.ProcessMessage=n.ProcessMessage;this.ProcessMessageForGAResponse=n.ProcessMessageForGAResponse;this.SetLocalNotifications=n.SetLocalNotifications;this.ResetLocalNotifications=n.ResetLocalNotifications;this.GameRefresh=n.GameRefresh;console.log("END app.Game")};n.PutInCommonConfigLocalStorage=function(n){localStorage.InCommon=JSON.stringify(n)};n.GetInCommonConfigLocalStorage=function(){return localResult=undefined,localStorage.InCommon!=undefined&&(localResult=JSON.parse(localStorage.InCommon)),localResult};n.PutGameLocalStorage=function(n){localStorage.Game=JSON.stringify(n)};n.GetGameLocalStorage=function(){return localResult=undefined,localStorage.Game!=undefined&&(localResult=JSON.parse(localStorage.Game)),localResult};n.PutResultLocalStorage=function(n){localStorage.Result=JSON.stringify(n)};n.GetResultLocalStorage=function(){return localResult={},localStorage.Result!=undefined&&(localResult=JSON.parse(localStorage.Result)),localResult};n.PutGameQueueLocalStorage=function(n){localStorage.GameQueue=JSON.stringify(n)};n.GetGameQueueLocalStorage=function(){return GameQueue=[],localStorage.GameQueue!=undefined&&(GameQueue=JSON.parse(localStorage.GameQueue)),GameQueue};n.PutGameListQueueLocalStorage=function(n){localStorage.GameListQueue=JSON.stringify(n)};n.GetGameListQueueLocalStorage=function(){return GameListQueue=[],localStorage.GameListQueue!=undefined&&(GameListQueue=JSON.parse(localStorage.GameListQueue)),GameListQueue};n.PutGameConfigLocalStorage=function(n){localStorage.GameConfig=JSON.stringify(n)};n.GetGameConfigLocalStorage=function(){return gameConfig={},localStorage.GameConfig!=undefined&&(gameConfig=JSON.parse(localStorage.GameConfig)),gameConfig};n.ajaxHelper=function(n,t,i,r){return console.log("START app.ajaxHelper uri:"+n),$.ajax({type:t,async:i,timeout:nr,url:n,dataType:"json",contentType:"application/json",data:r?JSON.stringify(r):null})};n.init()}({});GameStatusResponseForPing=function(){console.log("START GameStatusResponseForPing");console.log("END GameStatusResponseForPing")};GameStatusResponseForGameResumeAction=function(n){console.log("START GameStatusResponseForGameResumeAction");theApp=n.App;clientReportAccess=n.UserArg1;errorId=n.ErrorId;errorMessage=n.ErrorMessage;theApp.CompleteGameResumeAction(clientReportAccess,errorId,errorMessage);console.log("END GameStatusResponseForGameResumeAction")};GameStatusResponseForGameReportAction=function(n){console.log("START GameStatusResponseForGameReportAction");theApp=n.App;clientReportAccess=n.UserArg1;errorId=n.ErrorId;errorMessage=n.ErrorMessage;theApp.CompleteGameReportAction(clientReportAccess,errorId,errorMessage);console.log("END GameStatusResponseForGameReportAction")}})