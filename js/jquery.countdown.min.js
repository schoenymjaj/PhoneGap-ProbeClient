(function(n){n.fn.countdown=function(t,i){function a(){var h=n("#"+w.attr("id")),f,a;if(r.auxId1!=null&&(f=n("#"+r.auxId1)),r.auxId2!=null&&(a=n("#"+r.auxId2)),k()!="true"){console.log("(id = "+r.id+") countdown aborted!!!!!");clearInterval(l);return}bufferDate=r.date;bufferTimeInMilliseconds=0;r.id=="qdeadline"&&(bufferDate=r.date-1e3*r.dateBufferSecs,bufferTimeInMilliseconds=1e3*r.bufferTimeSecs);var ut=new Date(bufferDate),ft=b(),t=ut-ft;if(t<0-bufferTimeInMilliseconds){clearInterval(l);v("false");i&&typeof i=="function"&&i();return}if(t>=0){var it=1e3,nt=it*60,tt=nt*60,rt=tt*24,s=Math.floor(t/rt),d=Math.floor(t%rt/tt),g=Math.floor(t%tt/nt),u=Math.floor(t%nt/it);r.clockInd&&(u>=60-r.dateViewSecs&&u<=59?(innerCountDownClockHtml='<li><span class="tailHtml"><\/span><\/li>',h.html(innerCountDownClockHtml),r.auxId1!=null&&f.html(innerCountDownClockHtml),tailHtmlDateNow=s!=0?o:e,settingsDateLocal=new Date(r.date.getFullYear(),r.date.getMonth(),r.date.getDate(),r.date.getHours(),r.date.getMinutes()+r.date.getTimezoneOffset(),r.date.getSeconds()),dateLocalStr=GetInCommmonLocaleDateString(settingsDateLocal)+" "+GetInCommmonLocaleTimeString(settingsDateLocal),h.find(".tailHtml").html('<span style="background-color:black">'+dateLocalStr+"<\/span>"+tailHtmlDateNow),r.auxId1!=null&&f.find(".tailHtml").html('<span style="background-color:black">'+dateLocalStr+"<\/span>"+tailHtmlDateNow),r.auxId2!=null&&p(s,g,d,u,a)):(y(s,g,d,u,h),r.auxId1!=null&&y(s,g,d,u,f),r.auxId2!=null&&p(s,g,d,u,a)),c(t,r,h),r.auxId1!=null&&c(t,r,f),r.auxId2!=null&&c(t,r,a),console.log("countdown:(id="+r.id+")"))}}function k(){return r.OneTimeInd?"true":n("#"+r.divAnchor).attr("countdown-enabled-"+r.id)}function v(t){r.OneTimeInd||n("#"+r.divAnchor).attr("countdown-enabled-"+r.id,t)}function d(n){n.id=="qstart"?(u=" secs to next question",f=" to next question",e=" to next question",o=" to next question",s="<span>Countdown before the<br/>next question is served up<\/span>",h="<span>Date that the<br/>next question is served up<\/span>"):(u=" secs to answer deadline",f=" to answer deadline",e=" to answer deadline",o=" to answer deadline",s="<span>Deadline countdown for an<br/>answer to be submitted<\/span>",h="<span>Deadline date for an<br/>answer to be submitted<\/span>")}function c(t,i,r){new Date(t).getTime()/1e3<i.warningSecs?n(".countdownStyle").css("color",i.warningColor):n(".countdownStyle").css("color",i.color);r.find(".days").css("background-color","black");r.find(".hours").css("background-color","black");r.find(".minutes").css("background-color","black");r.find(".seconds").css("background-color","black");r.css("text-shadow","0 0px 0")}function y(n,t,i,r,e){innerCountDownClockHtml='<li><span class="days"><\/span><\/li>                        <li id="clockSepD"><\/li>                        <li><span class="hours"><\/span><\/li>                        <li id="clockSepH"><\/li>                        <li><span class="minutes"><\/span><\/li>                        <li id="clockSepM"><\/li>                        <li><span class="seconds"><\/span><\/li>                        <li><span class="tailHtml"><\/span><\/li>';e.html(innerCountDownClockHtml);var s,h,c,o;s=n;h=String(i).length<=1&&n!=0?"0"+i:i;c=String(t).length<=1&&i!=0?"0"+t:t;o=String(r).length<=1&&t!=0?"0"+r:r;iSeparator=":";iDaySeparator=".";n==0?(e.find(".days").parent().remove(),e.find("#clockSepD").remove()):(e.find(".days").text(s+"d"),e.find("#clockSepD").text(iDaySeparator));n==0&&i==0?(e.find(".hours").parent().remove(),e.find("#clockSepH").remove()):(e.find(".hours").text(h+"h"),e.find("#clockSepH").text(iSeparator));n==0&&i==0&&t==0?(e.find(".minutes").parent().remove(),e.find("#clockSepM").remove()):(e.find(".minutes").text(c+"m"),e.find("#clockSepM").text(iSeparator));n>=1||i>=1||t>1?e.find(".seconds").text(o):e.find(".seconds").text(o);n!=0?e.find(".tailHtml").html(f):e.find(".tailHtml").html(u)}function g(){n("#popupClockCountdownTitle").html(s);n("#popupClockDateTitle").html(h);settingsDateLocal=new Date(r.date.getFullYear(),r.date.getMonth(),r.date.getDate(),r.date.getHours(),r.date.getMinutes()+r.date.getTimezoneOffset(),r.date.getSeconds());n("#popupClockDate").html("<span>"+GetInCommmonLocaleDateString(settingsDateLocal)+"<\/span><br/><span>"+GetInCommmonLocaleTimeString(settingsDateLocal)+"<\/span>")}function p(n,t,i,r,u){innerCountDownClockHtml='<li>                                    <span class="days">00<\/span>                                    <p class="days_ref">days<\/p>                                    <\/li>                                    <li class="seperator">.<\/li>                                    <li> <span class="hours">00<\/span>                                    <p class="hours_ref">hours<\/p>                                    <\/li>                                    <li class="seperator">:<\/li>                                    <li> <span class="minutes">00<\/span>                                    <p class="minutes_ref">minutes<\/p>                                    <\/li>                                    <li class="seperator">:<\/li>                                    <li> <span class="seconds">00<\/span>                                    <p class="seconds_ref">seconds<\/p>                                    <\/li>';u.html(innerCountDownClockHtml);var f,e,o,s;f=String(n).length>=2?n:"0"+n;e=String(i).length>=2?i:"0"+i;o=String(t).length>=2?t:"0"+t;s=String(r).length>=2?r:"0"+r;iSeparator=":";iDaySeparator=".";u.find(".days").text(f);u.find("#clockSepD").text(iDaySeparator);u.find(".hours").text(e);u.find("#clockSepH").text(iSeparator);u.find(".minutes").text(o);u.find("#clockSepM").text(iSeparator);u.find(".seconds").text(s)}var r=n.extend({id:null,divAnchor:null,date:null,dateBufferSecs:0,bufferTimeSecs:0,clockInd:!1,OneTimeInd:!1,interval:1,color:"#a7abb1",warningSecs:60,warningColor:"red",dateViewSecs:10,staticInd:!1,auxId1:null,auxId2:null},t),u,f,e,o,s,h="",w=this,b=function(){var n=new Date;return new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds()))},l;r.date||n.error("Date is not defined.");Date.parse(r.date)||n.error("Incorrect date format, it should look like this, 12/24/2012 12:00:00.");v("true");d(r);g();a();r.OneTimeInd||(l=setInterval(a,r.interval*1e3))}})(jQuery)